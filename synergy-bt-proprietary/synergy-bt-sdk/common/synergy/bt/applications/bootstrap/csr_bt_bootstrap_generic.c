/****************************************************************************

Copyright (c) 2009-2013 Qualcomm Technologies International, Ltd. 
All Rights Reserved. 
Qualcomm Technologies International, Ltd. Confidential and Proprietary.

REVISION:      $Revision: #2 $
****************************************************************************/

#include "csr_synergy.h"

/* IMPORTANT NOTICE: This file contains generic functions for the CSR
 * Synegy BlueCore bootstrap system. You should NOT touch anything
 * here. Instead use the 'csr_bt_boot_specific.c/h' files to set up
 * the bootstrap for your particular system */

#include "csr_bt_bootstrap_generic.h"
#include "csr_bt_bootstrap_specific.h"
#include "csr_tm_bluecore_bootstrap.h"
#include "csr_file.h"
#include "csr_log_text.h"
#include "csr_macro.h"
#include "csr_bccmd_lib.h"
#ifdef CSR_USE_QCA_CHIP
#include "csr_dir.h"
#endif
 
/* Check that we are not trying to use both file-based and
 * constant-based PSR files */
#if defined(CSR_BT_BOOTSTRAP_PATCH_FILE) && defined(CSR_BT_BOOTSTRAP_PATCH_STRING)
#error "Both CSR_BT_BOOTSTRAP_PATCH_FILE and CSR_BT_BOOTSTRAP_PATCH_STRING defined. Choose one and not both"
#endif
#if defined(CSR_BT_BOOTSTRAP_PLATFORM_FILE) && defined(CSR_BT_BOOTSTRAP_PLATFORM_STRING)
#error "Both CSR_BT_BOOTSTRAP_PLATFORM_FILE and CSR_BT_BOOTSTRAP_PLATFORM_STRING defined. Choose one and not both"
#endif

/* Select sane defaults */
#ifndef CSR_BT_BOOTSTRAP_LINE_BUFFER
#define CSR_BT_BOOTSTRAP_LINE_BUFFER 2000
#endif

/* Misc constants */
#define CSR_BT_BOOTSTRAP_VARID_WARM_RESET            ((CsrUint16)0x4002)

/* Special ps-keys */
#define CSR_BT_BOOTSTRAP_PSKEY_UART_ACK_TIMEOUT      ((CsrUint16)0x01c4)
#define CSR_BT_BOOTSTRAP_PSKEY_UART_BITRATE          ((CsrUint16)0x01EA)
#define CSR_BT_BOOTSTRAP_PSKEY_UART_BAUDRATE         ((CsrUint16)0x01BE)
#define CSR_BT_BOOTSTRAP_PSKEY_ANA_FREQ              ((CsrUint16)0x01FE)
#define CSR_BT_BOOTSTRAP_PSKEY_ANA_FTRIM             ((CsrUint16)0x01F6)
#define CSR_BT_BOOTSTRAP_PSKEY_BDADDR                ((CsrUint16)0x0001)
#define CSR_BT_BOOTSTRAP_PSKEY_DEVICE_NAME           ((CsrUint16)0x0108)
#define CSR_BT_BOOTSTRAP_PSKEY_HOST_INTERFACE        ((CsrUint16)0x01F9)

#ifdef CSR_USE_QCA_CHIP
#define CSR_ROME_PATCH_NVM_MAP_LEN                                   (6)
#define _BINPATH_	DEFAULT_QCA_FIRMWARE_PATH

#define CSR_NVM_BIN_OFFSET_FIRST_TAG                                 (4)
#define CSR_RAM_PATCH_OFFSET_DOWNLOAD_CFG                           (14)

#define CSR_NVM_BIN_LEN_TAG_ID                                       (2)
#define CSR_NVM_BIN_LEN_TAG_LEN                                      (2)
/*include section of Pointer and Extended Flag*/
#define CSR_NVM_BIN_LEN_TAG_RESERVED                             (4 + 4)
#define TAG_SET_BT_ADDR                                              (2)
#define TAG_TRANSPORT_PARAM                                         (17)

/* FW IBS Configuration */
#define FWCONF_IBS_DISABLE                                           (0)
#define FWCONF_IBS_ENABLE                                            (1)
#define FWCONF_IBS_VAL_BIT                                           (7)
#define FWCONF_IBS_VAL_OFFSET                                        (0)

#define CSR_QSOC_MAX_BD_ADDRESS_SIZE                                0x06

/* pointer to the ROME RAM patch file name */
static CsrCharString *bt_rome_ram_patch_file = NULL;
/* pointer to the ROME NVM file name */
static CsrCharString *bt_rome_nvm_file = NULL;

#define SOC_VER_QCA6574 0x0044
#define SOC_VER_TUFFALO 0x0023
static CsrBool qcFirmwareLogEnable = FALSE;
static const csrRomePatchNvmMap rome_patch_nvm_map[CSR_ROME_PATCH_NVM_MAP_LEN] = 
{
    { 0x0000,          0x0101, {1, 1}, _BINPATH_"rampatch_tlv.img",     _BINPATH_"nvm_tlv.bin"},
    { 0x0000,          0x0200, {1, 3}, _BINPATH_"rampatch_tlv_1.3.tlv", _BINPATH_"nvm_tlv_1.3.bin"},
    { 0x0011,          0x0200, {2, 1}, _BINPATH_"rampatch_tlv_2.1.tlv", _BINPATH_"nvm_tlv_2.1.bin"},
    { 0x0022,          0x0300, {3, 0}, _BINPATH_"btfw30.tlv",           _BINPATH_"btnv30.bin"},
    { SOC_VER_QCA6574, 0x0302, {3, 0}, _BINPATH_"btfw32.tlv",           _BINPATH_"btnv32.bin"},
    { SOC_VER_TUFFALO, 0x0302, {3, 0}, _BINPATH_"rampatch_tlv_tf.tlv",  _BINPATH_"nvm_tlv_tf.nvm"}
};

QsocBtCfgElementType bt_qsoc_cfg_tag_2_ram[] = 
{
    0x02, 0x00, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA
};

/* Mini NVM file in a string.Contains BD addr only
   Byte 0 - NVM file type
   Byte [1 to 3] - length of the nvm data that follows
   Byte [4 - till end] - NVM Data */
CsrUint8 nvm_file_string[] = 
{
    0x02, 0x12, 0x00, 0x00,
    0x02, 0x00, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA
};

#define saved_bt_bd_addr (&bt_qsoc_cfg_tag_2_ram[CSR_NVM_BIN_LEN_TAG_ID + CSR_NVM_BIN_LEN_TAG_LEN + CSR_NVM_BIN_LEN_TAG_RESERVED])
#endif /* CSR_USE_QCA_CHIP */

#ifdef CSR_LOG_ENABLE
static const CsrLogSubOrigin csrBtBootstrapSubOrigins[] =
{
    { 0, "CSR_BT_BOOTSTRAP" }
};
#define CSR_BT_BOOTSTRAP_LOG(a,b) CSR_LOG_TEXT_WARNING((CsrSchedTaskQueueGet(), 0, (a), (b)))
#else
#define CSR_BT_BOOTSTRAP_LOG(a,b)
#endif


/* Get bootstrap context */
static csrBtBootstrapInst *_csr_bt_bootstrap_inst = NULL;
static csrBtBootstrapInst *csrBtBootstrapGetInst(void *bootContext)
{
    if(bootContext != NULL)
    {
        return (csrBtBootstrapInst*)bootContext;
    }
    else if(_csr_bt_bootstrap_inst != NULL)
    {
        return _csr_bt_bootstrap_inst;
    }
    else
    {
        _csr_bt_bootstrap_inst = (csrBtBootstrapInst*)CsrPmemZalloc(sizeof(csrBtBootstrapInst));
        return _csr_bt_bootstrap_inst;
    }
}

/* Build BCCMD from PSkey */
static CsrUint8 *csrBtBootstrapBuildPskBccmd(CsrUint16 key,
                                             CsrUint16 *data,
                                             CsrUint16 length,
                                             CsrUint16 store)
{
    CsrUint16 bccmdLength;
    CsrUint16 psPayloadLength = 0;
    CsrUint8 *psPayload = NULL;

    if(data)
    {
        psPayloadLength = (length * sizeof(CsrUint16));
        psPayload = (CsrUint8*)CsrPmemAlloc(psPayloadLength);
        CsrMemCpy(psPayload, data, psPayloadLength);
    }
    return CsrBccmdPsKeyCommandBuild(CSR_BCCMD_SET_REQ,
                                     0, /* sequence number, not used */
                                     key, store, psPayloadLength, psPayload, &bccmdLength);

}

/* Scan cached PSkeys and see if key exists */
static csrBtBoostrapCmd *csrBtBootstrapGetPskey(void *bootContext, CsrUint16 key)
{
    csrBtBootstrapInst *inst;
    csrBtBoostrapCmd *cmd;
    inst = csrBtBootstrapGetInst(bootContext);

    for(cmd = inst->ps_head; cmd != NULL; cmd = cmd->next)
    {
        if(cmd->key == key)
        {
            return cmd;
        }
    }
    return NULL;
}

/* Allocate new PSkey at end of list */
static csrBtBoostrapCmd *csrBtBootstrapAppendPskey(void *bootContext)
{
    csrBtBootstrapInst *inst;

    inst = csrBtBootstrapGetInst(bootContext);
    if(inst->ps_head == NULL)
    {
        inst->ps_head = CsrPmemZalloc(sizeof(csrBtBoostrapCmd));
        inst->ps_tail = inst->ps_head;
    }
    else
    {
        inst->ps_tail->next = CsrPmemZalloc(sizeof(csrBtBoostrapCmd));
        inst->ps_tail = inst->ps_tail->next;
    }

    return inst->ps_tail;
}

/* Calculate host interface baud-rate PS-Key based on the requested bitRate. */
static CsrUint16 csrBtBootstrapBitToBaud(CsrUint32 bitRate)
{
    return (CsrUint16)((((bitRate/100) * 4096) + 5000) / 10000);
}

/* Apply function based user settings */
#define CSR_BT_BCSP_MAX_PACKAGE_LENGTH (512+4) /* 0xfff is the maximum payload af a BCSP package. 
                                                  but we use the max ACL data package length as an 
                                                  indicator of what will actially be used. 
                                                  PSKEY_H_HC_FC_MAX_ACL_PKT_LEN has a MAX of 512*/
#define CSR_BT_BCSP_PROCESS_TIME_MS (8)
#define CSR_BT_BCSP_UART_BIT_PER_BYTE (11) 
static void csrBtBootstrapApplyUserSettings(void *bootContext)
{
    csrBtBootstrapInst *inst;
    csrBtBoostrapCmd *cmd;
    inst = csrBtBootstrapGetInst(bootContext);

    if(inst->bitRate != 0)
    {
        if(inst->bc7up)
        {
            /* BC7 and newer uses bitrate. Bit rate is 32bits, 2 xap words */
            cmd = csrBtBootstrapGetPskey(inst, CSR_BT_BOOTSTRAP_PSKEY_UART_BITRATE);
            if(cmd == NULL)
            {
                cmd = csrBtBootstrapAppendPskey(inst);
                cmd->key = CSR_BT_BOOTSTRAP_PSKEY_UART_BITRATE;
                cmd->length = 2; /* num xap words */
                cmd->data = CsrPmemAlloc(cmd->length * sizeof(CsrUint16));
            }
            cmd->data[0] = (CsrUint16)(inst->bitRate >> 16);
            cmd->data[1] = (CsrUint16)(inst->bitRate & 0x0000FFFF);
        }
        else
        {
            /* BC6 and older uses baudrate. Baud rate is 16bits, 1 xap word */
            CsrUint16 baud;
            baud = csrBtBootstrapBitToBaud(inst->bitRate);
            cmd = csrBtBootstrapGetPskey(inst, CSR_BT_BOOTSTRAP_PSKEY_UART_BAUDRATE);
            if(cmd == NULL)
            {
                cmd = csrBtBootstrapAppendPskey(inst);
                cmd->key = CSR_BT_BOOTSTRAP_PSKEY_UART_BAUDRATE;
                cmd->length = 1; /* num xap words */
                cmd->data = CsrPmemAlloc(cmd->length * sizeof(CsrUint16));
            }
            cmd->data[0] = baud;
        }
#if 0   
        Only reduce the re-transmission timer on systems that are able to handle the incomming messages
        in a timely manner at all times. 
        cmd = csrBtBootstrapGetPskey(inst, CSR_BT_BOOTSTRAP_PSKEY_UART_ACK_TIMEOUT);
        if(cmd == NULL)
        {
            cmd = csrBtBootstrapAppendPskey(inst);
            cmd->key = CSR_BT_BOOTSTRAP_PSKEY_UART_ACK_TIMEOUT;
            cmd->length = 1; /* num xap words */
            cmd->data = CsrPmemAlloc(cmd->length * sizeof(CsrUint16));
        }
        /* There is only one timer and the timer is reset each time a any package is send, and each time any new ACK 
           is received. This makes the timeout independent of the window size, and worst case would be 2 of these 
           packages: The outgoing package, and the incoming package with an updated ack and payload data.
           In addition to this there can be two full SLIP packages. In total 2*2*CSR_BT_BCSP_MAX_PACKAGE_LENGTH of data. */
        cmd->data[0] = (CsrUint16)((2*2*CSR_BT_BCSP_MAX_PACKAGE_LENGTH*1000L) / (inst->bitRate/CSR_BT_BCSP_UART_BIT_PER_BYTE)) 
                        + 2*CSR_BT_BCSP_PROCESS_TIME_MS;
#endif        
    }

    if(inst->freq != 0)
    {
        /* Crystal frequency is 16bits, 1 xap word */
        cmd = csrBtBootstrapGetPskey(inst, CSR_BT_BOOTSTRAP_PSKEY_ANA_FREQ);
        if(cmd == NULL)
        {
            cmd = csrBtBootstrapAppendPskey(inst);
            cmd->key = CSR_BT_BOOTSTRAP_PSKEY_ANA_FREQ;
            cmd->length = 1; /* num xap words */
            cmd->data = CsrPmemAlloc(cmd->length * sizeof(CsrUint16));
        }
        cmd->data[0] = inst->freq;
    }

    if(inst->freqTrim != 0)
    {
        /* Frequency trim is 16bits, 1 xap word */
        cmd = csrBtBootstrapGetPskey(inst, CSR_BT_BOOTSTRAP_PSKEY_ANA_FTRIM);
        if(cmd == NULL)
        {
            cmd = csrBtBootstrapAppendPskey(inst);
            cmd->key = CSR_BT_BOOTSTRAP_PSKEY_ANA_FTRIM;
            cmd->length = 1; /* num xap words */
            cmd->data = CsrPmemAlloc(cmd->length * sizeof(CsrUint16));
        }
        cmd->data[0] = inst->freqTrim;
    }

    if(!CsrBtBdAddrEqZero(&inst->address))
    {
        /* Device address is 64 bits, 4 xap words */
        cmd = csrBtBootstrapGetPskey(inst, CSR_BT_BOOTSTRAP_PSKEY_BDADDR);
        if(cmd == NULL)
        {
            cmd = csrBtBootstrapAppendPskey(inst);
            cmd->key = CSR_BT_BOOTSTRAP_PSKEY_BDADDR;
            cmd->length = 4; /* num xap words */
            cmd->data = CsrPmemAlloc(cmd->length * sizeof(CsrUint16));
            cmd->data[0] = (CsrUint16)(inst->address.lap >> 16);
            cmd->data[1] = (CsrUint16)(inst->address.lap & 0x0000FFFF);
            cmd->data[2] = (CsrUint16)(inst->address.uap);
            cmd->data[3] = (CsrUint16)(inst->address.nap);            
        }
    }

    if(inst->name[0] != '\0')
    {
        /* Device name is variable length with two characters per
         * xap-word. Always do a full free/alloc/patch of the name. */
        CsrUint16 len;
        cmd = csrBtBootstrapGetPskey(inst, CSR_BT_BOOTSTRAP_PSKEY_DEVICE_NAME);
        if(cmd != NULL)
        {
            CsrPmemFree(cmd->data);
        }
        else
        {
            cmd = csrBtBootstrapAppendPskey(inst);
            cmd->key = CSR_BT_BOOTSTRAP_PSKEY_DEVICE_NAME;
        }

        /* Two chars per word. If remainder, add modulus to make it even */
        len = CSRMIN((CsrUint16)CsrUtf8StringLengthInBytes(inst->name), CSR_BT_MAX_FRIENDLY_NAME_LEN);
        len = (len/sizeof(CsrUint16)) + (len%sizeof(CsrUint16));
        cmd->length = len;
        cmd->data = CsrPmemZalloc(len * sizeof(CsrUint16));
        CsrMemCpy((CsrCharString*)cmd->data,
                  inst->name,
                  CSRMIN(CsrUtf8StringLengthInBytes(inst->name), CSR_BT_MAX_FRIENDLY_NAME_LEN));
    }

    if(inst->iface != 0)
    {
        /* Host interface is 16bits, 1 xap word */
        cmd = csrBtBootstrapGetPskey(inst, CSR_BT_BOOTSTRAP_PSKEY_HOST_INTERFACE);
        if(cmd == NULL)
        {
            cmd = csrBtBootstrapAppendPskey(inst);
            cmd->key = CSR_BT_BOOTSTRAP_PSKEY_HOST_INTERFACE;
            cmd->length = 1; /* num xap words */
            cmd->data = CsrPmemAlloc(cmd->length * sizeof(CsrUint16));
        }
        cmd->data[0] = inst->iface;
    }
}

/* Convert PSkey table to BCCMD commands */
static CsrUint8 **csrBtBootstrapConvertTable(void *bootContext, CsrUint16 *entries)
{
    csrBtBootstrapInst *inst;
    CsrUint16 i;
    csrBtBoostrapCmd *psk;
    CsrUint8 **table;

    inst = csrBtBootstrapGetInst(bootContext);

    for(i=0, psk = inst->ps_head; psk != NULL; psk = psk->next)
    {
        i++;
    }
    i++; /* Make room for the warm reset */
    *entries = i;
    table = (CsrUint8**)CsrPmemZalloc(sizeof(CsrUint8**) * i);

    for(i=0; inst->ps_head; i++)
    {
        psk = inst->ps_head->next;
        table[i] = csrBtBootstrapBuildPskBccmd(inst->ps_head->key,
                                               inst->ps_head->data,
                                               inst->ps_head->length,
                                               CSR_BCCMD_STORES_PSRAM);
        CsrPmemFree(inst->ps_head->data);
        CsrPmemFree(inst->ps_head);
        inst->ps_head = psk;
    }
    inst->ps_head = NULL;
    inst->ps_tail = NULL;

    table[i] = CsrTmBlueCoreBuildBccmdSetMsg(CSR_BT_BOOTSTRAP_VARID_WARM_RESET,
                                             0, NULL);

    return table;
}

static CsrBool csrBtBootstrapIsFill(CsrCharString ch)
{
    if(ch == ' ' || ch == '\f' || ch == '\r' || ch == '\n' || ch == '\t')
    {
        return TRUE;
    }
    else
    {
        return FALSE;
    }
}

/* Parse PSR line. Format is "&kkkk=pppp...0", where k is key, p is
 * payload and 0 is the zero-terminator. Whitespace may appear
 * anywhere. Anything after a '#' is ignored. Returns TRUE if line is
 * valid, FALSE otherwise */
static CsrBool csrBtBootstrapParsePsrLine(CsrCharString *line, CsrUint16 *key,
                                          CsrUint16 *data, CsrUint16 *count)
{
    CsrUint32 idx;
    CsrUint16 elm;
    CsrUint8 wi;

    *count = 0;
    *key = 0;
    elm = 0;
    wi = 0;

    /* Sanity */
    if(line == NULL)
    {
        return FALSE;
    }

    for(idx=0; /* use breaks in code */; idx++)
    {
        if(csrBtBootstrapIsFill(line[idx]))
        {
            /* Whitespace. Ignore and next. */
            continue;
        }
        else if(line[idx] == '#' || 
                line[idx] == '\0' ||
                line[idx] == '/')
        {
            /* Comment or end of line. Stop. */
            break;
        }
        else if(line[idx] >= '0' && line[idx] <= '9' && wi < 4)
        {
            elm = (CsrUint16)((elm << 4) | (line[idx] - '0'));
            wi++;
        }
        else if(line[idx] >= 'a' && line[idx] <= 'f' && wi < 4)
        {
            elm = (CsrUint16)((elm << 4) | (line[idx] - 'a' + 0xa));
            wi++;
        }
        else if(line[idx] >= 'A' && line[idx] <= 'F' && wi < 4)
        {
            elm = (CsrUint16)((elm << 4) | (line[idx] - 'A' + 0xa));
            wi++;
        }
        else if(line[idx] == '&' && wi == 0 && *key == 0)
        {
            /* Key start token. Ignore and next. */
            continue;
        }
        else if(line[idx] == '=' && wi == 4 && *key == 0)
        {
            /* Payload start token and key complete. Store and fetch
             * next */
            *key = elm;
            wi = 0;
            elm = 0;
            continue;
        }
        else
        {
            /* Invalid character. Stop. */
            break;
        }

        /* Complete payload word */
        if(*key != 0 && wi == 4)
        {
            data[*count] = elm;
            (*count)++;
            wi = 0;
            elm = 0;
        }
    }

    /* Entry only valid if key and payload existed and terminated
     * after a full word */
    if(*key != 0 && *count > 0 && wi == 0)
    {
        return TRUE;
    }
    else
    {
        return FALSE;
    }
}

/* Add PSKEY */
void CsrBtBootstrapAddPskey(void *bootContext, CsrUint16 key, CsrUint16 *data, CsrUint16 length)
{
    csrBtBootstrapInst *inst;
    csrBtBoostrapCmd *cmd;

    inst = csrBtBootstrapGetInst(bootContext);
    cmd = csrBtBootstrapAppendPskey(inst);
    cmd->next = NULL;
    cmd->key = key;
    cmd->data = data;
    cmd->length = length;
}

/* High-level constant-string PSR parser */
void CsrBtBootstrapParsePsrConstant(void *bootContext, const CsrCharString *string)
{
    CsrCharString *line;
    CsrUint32 index;
    CsrUint32 outdex;
    CsrUint16 *data;
    CsrUint16 length;
    CsrUint16 key;

    CSR_BT_BOOTSTRAP_LOG("Parsing PSR string constant at address '%x'", (unsigned int)string);

    if(string == NULL)
    {
        return;
    }

    index = 0;
    outdex = 0;
    line = CsrPmemZalloc(CSR_BT_BOOTSTRAP_LINE_BUFFER);
    while(string[index] != '\0')
    {
        line[outdex] = string[index];
        if(string[index] == '\n' ||
           string[index] == '\r')
        {
            data = CsrPmemZalloc(outdex/2);
            if(csrBtBootstrapParsePsrLine(line, &key, data, &length))
            {
                CsrBtBootstrapAddPskey(bootContext, key, data, length);
            }
            else
            {
                CsrPmemFree(data);
            }
            outdex = 0;
            CsrMemSet(line, 0, CSR_BT_BOOTSTRAP_LINE_BUFFER);
        }
        else
        {
            outdex++;
        }
        index++;
    }
    CsrPmemFree(line);
}

/* High-level PSR file parser */
void CsrBtBootstrapParsePsrFile(void *bootContext, const CsrCharString *filename)
{
    CsrFileHandle *fh;
    CsrResult res;
    CsrCharString *line;
    CsrUint32 index;
    CsrSize got;
    CsrUint16 *data;
    CsrUint16 length;
    CsrUint16 key;

    CSR_BT_BOOTSTRAP_LOG("Parsing PSR file '%s'", filename);

    res = CsrFileOpen(&fh, (const CsrUtf8String*)filename,
                      CSR_FILE_OPEN_FLAGS_READ_ONLY,
                      CSR_FILE_PERMS_USER_READ);
    /* Scan file */
    if(res == CSR_RESULT_SUCCESS)
    {
        line = CsrPmemZalloc(CSR_BT_BOOTSTRAP_LINE_BUFFER);
        while(res == CSR_RESULT_SUCCESS)
        {
            index = 0;
            CsrMemSet(line, 0, CSR_BT_BOOTSTRAP_LINE_BUFFER);

            /* Scan line */
            while(res == CSR_RESULT_SUCCESS
                  && index < (CSR_BT_BOOTSTRAP_LINE_BUFFER - 1))
            {
                res = CsrFileRead(&line[index], (CsrSize)1, fh, &got);
                if(res == CSR_RESULT_SUCCESS && got == 1)
                {
                    index++;
                    if(line[index-1] == '\n' ||
                       line[index-1] == '\r')
                    {
                        break;
                    }
                }
                else if (got == 0)
                {
                    /* Assume we reached EOF. Some platforms does not return ERROR in this case */
                    res = CSR_FILE_RESULT_EOF;
#ifdef CSR_LOG_ENABLE
                    CSR_BT_BOOTSTRAP_LOG("While reading PSR-file '%s', no data was returned. Assuming we reached EOF", filename);
#endif
                }
            }  
            
            data = CsrPmemZalloc(index/2);
            if(csrBtBootstrapParsePsrLine(line, &key, data, &length))
            {
                CsrBtBootstrapAddPskey(bootContext, key, data, length);
            }
            else
            {
                CsrPmemFree(data);
            }
        };
        CsrPmemFree(line);
        CsrFileClose(fh);
    }
    else
    {
        CsrPanic(CSR_TECH_BT, CSR_PANIC_FW_EXCEPTION,
                 "Could not open PSR file for reading");
    }
}

/* Set host interface transport */
void CsrBtBootstrapSetInterface(void *bootContext, CsrUint16 hostInterface)
{
    csrBtBootstrapInst *inst;
    inst = csrBtBootstrapGetInst(bootContext);

    switch(hostInterface)
    {
        case TRANSPORT_TYPE_BCSP:
            inst->iface = CSR_BT_BOOTSTRAP_PSKEY_HOST_INTERFACE_BCSP;
            break;

        case TRANSPORT_TYPE_USB:
            inst->iface = CSR_BT_BOOTSTRAP_PSKEY_HOST_INTERFACE_H2_USB;
            break;

#ifdef CSR_H4_TRANSPORT_ENABLE
        case TRANSPORT_TYPE_H4_UART:
            inst->iface = CSR_BT_BOOTSTRAP_PSKEY_HOST_INTERFACE_H4;
            break;
#endif
#ifdef CSR_H4DS_TRANSPORT_ENABLE
        case TRANSPORT_TYPE_H4_DS:
            inst->iface = CSR_BT_BOOTSTRAP_PSKEY_HOST_INTERFACE_H4DS;
            break;
#endif

        case TRANSPORT_TYPE_H4_I:    
            inst->iface = CSR_BT_BOOTSTRAP_PSKEY_HOST_INTERFACE_BCSP;
            break;

        case TRANSPORT_TYPE_TYPE_A:
            inst->iface = CSR_BT_BOOTSTRAP_PSKEY_HOST_INTERFACE_SDIO;
            break;

        default:
            CsrPanic(CSR_TECH_BT, CSR_PANIC_FW_EXCEPTION,
                     "Invalid host transport type");
            break;
    }
}

void CsrBtBootstrapSetBitRate(void *bootContext, CsrUint32 bitRate)
{
    csrBtBootstrapInst *inst;
    inst = csrBtBootstrapGetInst(bootContext);
    inst->bitRate = bitRate;
}

/* Set BlueCore friendly name */
void CsrBtBootstrapSetFriendlyName(void *bootContext, CsrUtf8String *name)
{
    csrBtBootstrapInst *inst;
    inst = csrBtBootstrapGetInst(bootContext);
    CsrMemSet(inst->name, 0, CSR_BT_MAX_FRIENDLY_NAME_LEN + 1);
    CsrStrLCpy(inst->name, name, CSR_BT_MAX_FRIENDLY_NAME_LEN + 1);
}

#ifdef CSR_USE_QCA_CHIP
void CsrBtBootstrapSetQcFirmwareLog(CsrBool logen)
{
    qcFirmwareLogEnable = logen;
}

/* TM expects this function to return if firmware logging over HCi for QC
   Chips is enabled */
CsrBool CsrTmQcGetFirmwareLogSetting(void)
{
    return qcFirmwareLogEnable;
}

/* Set Bluetooth address */
void CsrBtBootstrapSetLocalBtAddress(void *bootContext, CsrBtDeviceAddr *address)
{
    CsrMemCpy(&bt_qsoc_cfg_tag_2_ram[12], &address->lap, 3);
    CsrMemCpy(&bt_qsoc_cfg_tag_2_ram[15], &address->uap, 1);
    CsrMemCpy(&bt_qsoc_cfg_tag_2_ram[16], &address->nap, 2);
}
#else
/* Set Bluetooth address */
void CsrBtBootstrapSetLocalBtAddress(void *bootContext, CsrBtDeviceAddr *address)
{
    csrBtBootstrapInst *inst;
    inst = csrBtBootstrapGetInst(bootContext);
    CsrBtBdAddrCopy(&inst->address, address);
}
#endif

/* Set crystal frequency */
void CsrBtBootstrapSetFrequency(void *bootContext, CsrUint16 frequency)
{
    csrBtBootstrapInst *inst;
    inst = csrBtBootstrapGetInst(bootContext);
    inst->freq = frequency;
}

/* Set crystal frequency trim */
void CsrBtBootstrapSetFreqTrim(void *bootContext, CsrUint16 freqTrim)
{
    csrBtBootstrapInst *inst;
    inst = csrBtBootstrapGetInst(bootContext);
    inst->freqTrim = freqTrim;
}

/* Framework callback function. This is the main bootstrap
 * function. We are expected to return a byte array of BCCMDs with the
 * combined bootstrap */
CsrUint8 **CsrTmBlueCoreGetBootstrap(CsrUint16 buildId, CsrUint16 *entries)
{
    csrBtBootstrapInst *inst;
    /* [QTI] Fix KW issue#32522. */
    CsrUint8 **table = NULL;
    inst = csrBtBootstrapGetInst(NULL);

    /* Set default value to support most <bc7 without adding them to the table of known build ids. */
    if (buildId >= 6817)
    {
        inst->bc7up = TRUE;
    }
    else
    {
        inst->bc7up = FALSE;        
    }

#ifdef CSR_LOG_ENABLE
    CsrLogTextRegister(CsrSchedTaskQueueGet(),
                       "CSR_BT_BOOTSTRAP",
                       CSR_ARRAY_SIZE(csrBtBootstrapSubOrigins),
                       csrBtBootstrapSubOrigins);
#endif

    CSR_BT_BOOTSTRAP_LOG("BlueCore build-id detected as '%x'", buildId);

    /* Parse files or strings */
#if defined(CSR_BT_BOOTSTRAP_PATCH_FILE)
    CsrBtBootstrapParsePsrFile(inst, CSR_BT_BOOTSTRAP_PATCH_FILE);
#elif defined(CSR_BT_BOOTSTRAP_PATCH_STRING)
    CsrBtBootstrapParsePsrConstant(inst, CSR_BT_BOOTSTRAP_PATCH_STRING);
#endif

#if defined(CSR_BT_BOOTSTRAP_PLATFORM_FILE)
    CsrBtBootstrapParsePsrFile(inst, CSR_BT_BOOTSTRAP_PLATFORM_FILE);
#elif defined(CSR_BT_BOOTSTRAP_PLATFORM_STRING)
    CsrBtBootstrapParsePsrConstant(inst, CSR_BT_BOOTSTRAP_PLATFORM_STRING);
#endif

    CsrBtBootstrapSpecific((void*)inst, buildId, &(inst->bc7up));

    /* [QTI] Exclude to compile for QCA chip, because PSkey is specific with CSR BlueCore chip. */
#ifdef CSR_USE_BLUECORE_CHIP
    /* The following modification is moved from CsrSchedTaskInit() of csr_bt_task.c */
    if (CsrAppMainBluecorePsrFileGet())
    {
        CsrBtBootstrapParsePsrFile(NULL, CsrAppMainBluecorePsrFileGet());
    } 
    if (CsrAppMainBluecorePsrStringGet())
    {
        CsrBtBootstrapParsePsrConstant(NULL, CsrAppMainBluecorePsrStringGet());
    }

    csrBtBootstrapApplyUserSettings((void*)inst);
    table = csrBtBootstrapConvertTable((void*)inst, entries);
#endif

    /* done with the data unless having chip manager reset support,
       in which case the framework might call us again */
#ifndef CSR_CHIP_MANAGER_ENABLE
    CsrPmemFree(inst);
    _csr_bt_bootstrap_inst = NULL;
#endif

    return table;
}



#ifdef CSR_IBFP_H4I_SUPPORT
/** Type for BdData */
typedef struct
{
    CsrUint8 Command[3];
    CsrUint8 BdAddr[6];
    CsrUint8 ChannelWordOffset[2];
    CsrUint8 InputFreq[4];
    CsrUint8 LmpFeatures[8];
    CsrUint8 LE_Features ;
    CsrUint8 LpmConf;
    CsrUint8 LpmDrift;
    CsrUint8 LpmThreshold;
    CsrUint8 UlpmThreshold;
    CsrUint8 E_MP1[16] ;
    CsrUint8 RssiMin;
    CsrUint8 RssiMax;
    CsrUint8 RSSI_GoToMax ;
    CsrUint8 UartBaudrate;
    CsrUint8 UartInvert;
    CsrUint8 UartPulls;
    CsrUint8 OscSettle;
    CsrUint8 Pll_Settle ;
    CsrUint8 Dig_Settle ;
    CsrUint8 BbConf;
    CsrUint8 IDAC_Comp ;
    CsrUint8 RF_Conf;
    CsrUint8 LMP_Version;
    CsrUint8 ULPM_Currrent[2];
    CsrUint8 Idle_Currrent[2];
    CsrUint8 Active_Currrent[2];
    CsrUint8 TX_Currrent[2];
    CsrUint8 RX_Currrent[2];
    CsrUint8 reserved[16];
} InfineonWriteBdData;

/* will be used on PCWIN */
static const CsrUint8 bdData[]=
{
    0x00, 0x00, 0x00, /* dummy cmd */
    0xC3, 0xB2, 0xA1, 0x5B, 0x02, 0x00,
    0x00, 0x00, 0x80, 0xBA, 0x8C, 0x01, 0xFF, 0xFE, 0x0F, 0xF8,
    0x5B, 0x1E, 0x7B, 0x87, 0x01, 0x00, 0xFA, 0x1A, 0x20, 0xFA,
    0xFA, 0xFA, 0x02, 0x04, 0x01, 0x01, 0x01, 0xFA, 0xFA, 0xFA,
    0x02, 0x06, 0xFA, 0xA8, 0xFA, 0xBE, 0xC8, 0x0A, 0x04, 0x00,
    0x00, 0xA3, 0x07, 0x00, 0x0C, 0x00, 0x40, 0x00, 0x1E, 0x00,
    0xB8, 0x0B, 0x64, 0x19, 0xC8, 0xAF, 0xA8, 0x61, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00


};

CsrUint8 *CsrH4iGetBdData(CsrUint8 *length)
{
    static InfineonWriteBdData hwBdData;

    /* Read from NVM (which can be updated from phone tool) */
    CsrMemCpy((unsigned char *)&hwBdData, bdData, sizeof(InfineonWriteBdData));
    
    *length = sizeof(InfineonWriteBdData) - 3;
    
    return &(hwBdData.BdAddr[0]);
}

#ifdef CSR_H4I_ENABLE_PATCH
static const CsrUint8 patch[] =
{
    0xFA, 0x00, 0x00, 0x00, 0x21, 0x00, 0xF4, 0x01, 0x22, 0x01, 
    0xF0, 0x0A, 0xFC, 0xBF, 0xBC, 0x08, 0xBC, 0x18, 0x47, 0x1B, 
    0xDE, 0x16, 0x1C, 0x10, 0x43, 0x88, 0x62, 0x70, 0x47, 0x05, 
    0xDE, 0x84, 0x46, 0xE7, 0x4B, 0x01, 0x20, 0x00, 0x26, 0x62, 
    0x48, 0x63, 0x49, 0xC8, 0x60, 0xFE, 0xBC, 0x08, 0xBC, 0x18, 
    0x47, 0x07, 0xDE, 0x47, 0x4F, 0xFF, 0xF7, 0xEE, 0xFE, 0x20, 
    0x78, 0xFF, 0xF7, 0x46, 0xFF, 0x75, 0x48, 0x08, 0xDE, 0xC0, 
    0x38, 0x41, 0x61, 0x41, 0x69, 0x49, 0x00, 0x49, 0x08, 0x41, 
    0x61, 0x70, 0x47, 0x0F, 0xDE, 0x31, 0x49, 0x01, 0x29, 0x03, 
    0xD9, 0xC0, 0x78, 0xFE, 0xF7, 0x35, 0xFE, 0x0D, 0xDE, 0x05, 
    0x20, 0xFF, 0xF7, 0x0A, 0xD8, 0x0A, 0xDE, 0xC0, 0x30, 0x41, 
    0x69, 0x49, 0x01, 0x89, 0x0F, 0xFB, 0xD0, 0xFF, 0xF7, 0xD7, 
    0xE7, 0x10, 0xDE, 0xC1, 0x4C, 0x20, 0x69, 0x06, 0x04, 0xC3, 
    0x48, 0x36, 0x0C, 0x01, 0x78, 0x81, 0x86, 0x00, 0x20, 0x0C, 
    0xDE, 0x31, 0x4C, 0x20, 0x78, 0x02, 0x30, 0x20, 0x70, 0x01, 
    0x20, 0x00, 0xE0, 0x8E, 0x54, 0x11, 0xDE, 0xFC, 0xF7, 0x8D, 
    0xFA, 0x21, 0x78, 0x0E, 0x23, 0x5E, 0x4A, 0x15, 0xDE, 0x18, 
    0x48, 0xC0, 0x38, 0xC1, 0x6D, 0x49, 0x08, 0x49, 0x00, 0xC1, 
    0x65, 0xC1, 0x6E, 0x08, 0xBC, 0x18, 0x47, 0x10, 0xB5, 0x13, 
    0xDE, 0x44, 0x48, 0xC1, 0x6D, 0x10, 0x22, 0x91, 0x43, 0x08, 
    0x60, 0x10, 0xBC, 0x08, 0xBC, 0x18, 0x47, 0xB0, 0xB5, 0x17, 
    0xDE, 0x18, 0x48, 0xC1, 0x6D, 0x3F, 0x22, 0x12, 0x04, 0x91, 
    0x43, 0x08, 0x43, 0xE0, 0x60, 0x00, 0x20, 0x4C, 0xE6, 0x06, 
    0xDE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x00, 0x47, 0x45, 
    0xA1, 0x00, 0x00, 0x00, 0x20, 0x18, 0x47, 0x9B, 0x00, 0x00, 

    0xE0, 0x42, 0xF4, 0x00, 0x00, 0x21, 0x00, 0x3C, 0x01, 0x00, 
    0x80, 0xE0, 0x0C, 0x00, 0x86, 0xE5, 0x01, 0x00, 0xA0, 0xE3, 
    0x14, 0x20, 0x0F, 0x4F, 0x60, 0x43, 0x24, 0x37, 0xC0, 0x19, 
    0x81, 0x7C, 0x00, 0x29, 0x00, 0x00, 0x31, 0x60, 0x01, 0x1C, 
    0x20, 0x31, 0x8E, 0x46, 0x5E, 0x4B, 0x09, 0x78, 0x19, 0xDE, 
    0x34, 0x23, 0x10, 0x00, 0x02, 0xE6, 0x18, 0x30, 0x90, 0xE5, 
    0x01, 0x20, 0x82, 0xE2, 0x04, 0x20, 0x80, 0xE5, 0x56, 0x20, 
    0x00, 0x00, 0x92, 0x00, 0x50, 0xE3, 0x00, 0x00, 0x00, 0x61, 
    0x04, 0x00, 0x00, 0xCC, 0x04, 0x00, 0x00, 0x09, 0x05, 0x00, 
    0x00, 0x68, 0x05, 0x00, 0x00, 0x99, 0x05, 0x00, 0x00, 0x6A, 
    0x06, 0x00, 0x00, 0x8D, 0x07, 0x00, 0x00, 0x75, 0x08, 0x00, 
    0x00, 0xA5, 0x08, 0x00, 0x00, 0xB4, 0x08, 0x00, 0x00, 0xDA, 
    0x08, 0x00, 0x00, 0x16, 0x09, 0x00, 0x00, 0xBA, 0x09, 0x00, 
    0x00, 0x10, 0x36, 0x00, 0x00, 0xB3, 0x36, 0x00, 0x00, 0xDC, 
    0x3E, 0x00, 0x00, 0x54, 0x43, 0x00, 0x00, 0xB1, 0x4C, 0x00, 
    0x00, 0xFF, 0x7F, 0x00, 0x00, 0x9E, 0xBC, 0xB1, 0x00, 0x00, 
    0x00, 0x98, 0x6C, 0x00, 0x00, 0x92, 0x30, 0x01, 0x00, 0x21, 
    0x00, 0x00, 0x00, 0x00, 0xF4, 0xB1, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x0C, 0xB2, 0x00, 0x00, 0x24, 0xB2, 0x00, 0x00, 0x3C, 0xB2, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x36, 
    0x00, 0x80, 0x01, 0x20, 0x00, 0xE0, 0x00, 0x20, 0xCA, 0xF7, 
    0x7D, 0xFE, 0x00, 0xDE, 0x2E, 0xFC, 0x1F, 0x48, 0x00, 0x00, 
    0x00, 0x00, 0xDA, 0x36, 0x00, 0x80, 0x01, 0x20, 0x70, 0x47, 
    0x01, 0x20, 0x70, 0x47, 0x04, 0xDE, 0x70, 0x47, 0x1C, 0x48, 
    0x40, 0x68, 0x00, 0x00, 0x00, 0x00, 0x7D, 0x2D, 0x00, 0x80, 
    0xE0, 0x71, 0x02, 0x20, 0x20, 0x72, 0x04, 0x20, 0xA0, 0x70, 
    0xA8, 0x20, 0xE0, 0x70, 0x20, 0x20, 0x00, 0x00, 0x00, 0x00, 
    0x3F, 0x43, 0x00, 0x80, 0xB2, 0x4B, 0xB2, 0x4A, 0x50, 0x33, 
    0x18, 0x79, 0x60, 0x32, 0x80, 0x01, 0x20, 0x1C, 0xFE, 0xF7, 
    0x00, 0x00, 0x00, 0x00, 0xFA, 0x00, 0xA0, 0x00, 0x00, 0x00, 
    0xF4, 0xDB, 0xF0, 0x21, 0xE3, 0x02, 0xE0, 0x5E, 0xE5, 0x0E, 
    0xE1, 0x9F, 0xE7, 0x0E, 0xF0, 0xB0, 0xE1, 0x2D, 0xAF, 0x00, 
    0x00, 0x0E, 0x68, 0x03, 0x20, 0xE4, 0xA0, 0x00, 0x00, 0x14, 
    0xCB, 0x04, 0x20, 0xFD, 0xA1, 0x00, 0x00, 0x01, 0xA2, 0x00, 
    0x00, 0xED, 0xA6, 0x00, 0x00, 0x0D, 0xA6, 0x00, 0x00, 0x35, 
    0xAF, 0x00, 0x00, 0x9E, 0x50, 0x00, 0x20, 0x47, 0xAF, 0x00, 
    0x00, 0xAE, 0x66, 0x00, 0x20, 0x41, 0xA9, 0x00, 0x00, 0x4D, 
    0xAF, 0x00, 0x00, 0xA2, 0x59, 0x00, 0x20, 0x39, 0xAA, 0x00, 
    0x00, 0x0D, 0xAB, 0x00, 0x00, 0x55, 0xAF, 0x00, 0x00, 0x64, 
    0x8A, 0x00, 0x20, 0x61, 0xAF, 0x00, 0x00, 0xA8, 0x8D, 0x00, 
    0x20, 0x6D, 0xAF, 0x00, 0x00, 0x42, 0x8B, 0x00, 0x20, 0x79, 
    0xAF, 0x00, 0x00, 0x6C, 0x91, 0x00, 0x20, 0x85, 0xAF, 0x00, 
    0x00, 0x4E, 0x35, 0x04, 0x20, 0x49, 0xAD, 0x00, 0x00, 0x84, 
    0x10, 0x9F, 0xE5, 0x00, 0x01, 0x81, 0xE0, 0x0C, 0x00, 0x90, 
    0xE5, 0x78, 0x10, 0x9F, 0xE5, 0x00, 0x00, 0x50, 0xE3, 0x1E, 
    0xFF, 0x2F, 0x01, 0x00, 0x20, 0x0F, 0xE1, 0x80, 0x30, 0x82, 
    0xE3, 0x03, 0xF0, 0x2F, 0xE1, 0x08, 0x30, 0x91, 0xE5, 0x03, 
    0x00, 0x50, 0xE1, 0x0A, 0x00, 0x00, 0x0A, 0x08, 0x00, 0x81, 
    0xE5, 0x04, 0x30, 0x91, 0xE5, 0x00, 0x10, 0x91, 0xE5, 0xF0, 
    0x00, 0x2D, 0xE9, 0x04, 0x40, 0x90, 0xE4, 0x00, 0x00, 0x54, 
    0xE3, 0x04, 0x40, 0x81, 0x14, 0xF0, 0x00, 0xB0, 0x18, 0xF0, 
    0x00, 0xA3, 0x18, 0xF9, 0xFF, 0xFF, 0x1A, 0xF0, 0x00, 0xBD, 
    0xE8, 0x02, 0xF0, 0x2F, 0xE1, 0x1E, 0xFF, 0x2F, 0xE1, 0x00, 
    0x10, 0x90, 0xE5, 0x20, 0x20, 0x9F, 0xE5, 0x02, 0x00, 0x51, 
    0xE1, 0x03, 0x00, 0x00, 0x0A, 0xFA, 0xF4, 0xA0, 0x00, 0x00, 
    0x00, 0xF4, 0x01, 0x00, 0x2D, 0xE9, 0x01, 0x00, 0xA0, 0xE1, 
    0xDF, 0xFF, 0xFF, 0xEB, 0x01, 0x00, 0xBD, 0xE8, 0x04, 0x20, 
    0x90, 0xE5, 0x10, 0x00, 0x03, 0xE6, 0xBC, 0xB1, 0x00, 0x00, 
    0x44, 0x52, 0x48, 0x54, 0x17, 0x4A, 0x08, 0x20, 0xD0, 0x61, 
    0xC1, 0x05, 0x15, 0x48, 0x80, 0x38, 0x81, 0x62, 0x15, 0x49, 
    0x41, 0x62, 0x15, 0x48, 0x15, 0x49, 0x08, 0x61, 0x01, 0x20, 
    0x11, 0x49, 0x40, 0x06, 0x40, 0x31, 0x08, 0x62, 0x00, 0x20, 
    0xD0, 0x61, 0x12, 0x48, 0x1B, 0x21, 0x89, 0x01, 0x88, 0x62, 
    0x70, 0x47, 0x10, 0x48, 0x80, 0xB5, 0x00, 0x21, 0x48, 0x62, 
    0x0F, 0x48, 0x10, 0x4A, 0x01, 0xE0, 0x01, 0x70, 0x01, 0x30, 
    0x90, 0x42, 0xFB, 0xD3, 0x00, 0x20, 0x00, 0xF0, 0x1C, 0xFF, 
    0xFF, 0xF7, 0xD8, 0xFF, 0x00, 0x20, 0x00, 0xF0, 0x1B, 0xFF, 
    0x00, 0xF0, 0x21, 0xFF, 0x80, 0xBC, 0x08, 0xBC, 0x18, 0x47, 
    0x40, 0x01, 0x00, 0xBC, 0x28, 0x6A, 0x00, 0x00, 0xC4, 0xC3, 
    0x01, 0x00, 0x40, 0x03, 0x00, 0xBC, 0x01, 0x17, 0x0A, 0x04, 
    0x00, 0xA0, 0x00, 0x00, 0xBC, 0xB1, 0x00, 0x00, 0xBC, 0xB1, 
    0x00, 0x00, 0x17, 0x49, 0x80, 0xB5, 0x0A, 0x20, 0x08, 0x60, 
    0x16, 0x48, 0x09, 0x23, 0x02, 0x68, 0xDB, 0x01, 0xD2, 0x18, 
    0x03, 0x21, 0x91, 0x63, 0x02, 0x68, 0xC0, 0x33, 0xD2, 0x18, 
    0x04, 0x21, 0xD1, 0x60, 0x02, 0x68, 0x17, 0x23, 0x9B, 0x01, 
    0xD2, 0x18, 0x05, 0x21, 0x11, 0x62, 0x02, 0x68, 0x80, 0x33, 
    0xD2, 0x18, 0x06, 0x21, 0x51, 0x63, 0x02, 0x68, 0x07, 0x21, 
    0x0B, 0x02, 0xD2, 0x18, 0x91, 0x60, 0x02, 0x68, 0x80, 0x33, 
    0xD2, 0x18, 0x08, 0x21, 0xD1, 0x61, 0x00, 0x68, 0x01, 0x22, 
    0xD2, 0x02, 0x09, 0x21, 0x80, 0x18, 0xFA, 0xE8, 0xA1, 0x00, 
    0x00, 0x00, 0xF4, 0x01, 0x63, 0x00, 0xF0, 0xE9, 0xFE, 0x80, 
    0xBC, 0x08, 0xBC, 0x18, 0x47, 0x8C, 0x0D, 0x00, 0x00, 0x78, 
    0xE3, 0x04, 0x20, 0x10, 0x20, 0x70, 0x47, 0xF3, 0xB5, 0x00, 
    0x23, 0x84, 0xB0, 0x01, 0x93, 0x9C, 0x46, 0xE3, 0x4B, 0x01, 
    0x22, 0x52, 0x02, 0x00, 0x26, 0x00, 0x21, 0x9C, 0x18, 0xA2, 
    0x6A, 0xDE, 0x4D, 0x12, 0x05, 0xA2, 0x6A, 0x01, 0xDA, 0x12, 
    0x03, 0x00, 0xE0, 0x12, 0x01, 0xD3, 0x0E, 0xDC, 0x4A, 0x02, 
    0x93, 0x92, 0x79, 0x93, 0x07, 0x0E, 0xD5, 0x23, 0x6A, 0xDB, 
    0x05, 0x23, 0x6A, 0x02, 0xDA, 0x9B, 0x02, 0xDF, 0x0C, 0x01, 
    0xE0, 0xDF, 0x06, 0xFF, 0x0E, 0xBB, 0x00, 0xDB, 0x19, 0xF6, 
    0x33, 0x1B, 0x06, 0x1B, 0x0E, 0x9C, 0x46, 0xD3, 0x07, 0x08, 
    0xD5, 0x61, 0x6A, 0xC9, 0x03, 0x61, 0x6A, 0x02, 0xDA, 0x49, 
    0x01, 0x89, 0x0D, 0xFF, 0xE7, 0x09, 0x06, 0x09, 0x0E, 0x57, 
    0x07, 0xCD, 0x4A, 0x2C, 0x23, 0x12, 0x78, 0x5A, 0x43, 0xCC, 
    0x4B, 0xD2, 0x18, 0x00, 0x2F, 0x08, 0xDA, 0x93, 0x7A, 0xA7, 
    0x6A, 0xD8, 0x33, 0x7F, 0x05, 0xFF, 0x0E, 0x7B, 0x43, 0x1B, 
    0x06, 0x1B, 0x0E, 0x01, 0x93, 0x02, 0x9B, 0xC7, 0x4F, 0x63, 
    0x44, 0x59, 0x18, 0x01, 0x9B, 0xC9, 0x18, 0xC4, 0x4B, 0x1B, 
    0x78, 0xC9, 0x18, 0x09, 0x06, 0x09, 0x0E, 0x00, 0x91, 0x20, 
    0x32, 0x93, 0x79, 0xF9, 0x6A, 0x9C, 0x46, 0xFF, 0x22, 0x12, 
    0x02, 0x91, 0x43, 0xFA, 0x6A, 0x3F, 0x23, 0x9B, 0x02, 0x1A, 
    0x40, 0x11, 0x43, 0xF9, 0x62, 0x42, 0x00, 0x12, 0x18, 0x03, 
    0x92, 0xBA, 0x4A, 0x05, 0x99, 0xC0, 0x32, 0x01, 0x29, 0x71, 
    0xD1, 0xB8, 0x49, 0x63, 0x46, 0xC9, 0x5C, 0xB8, 0x4B, 0x00, 
    0x29, 0x1B, 0xD1, 0x50, 0x68, 0x70, 0x21, 0xFA, 0xDC, 0xA2, 
    0x00, 0x00, 0x00, 0xF4, 0x88, 0x43, 0x03, 0x99, 0x59, 0x5C, 
    0x70, 0x23, 0x49, 0x00, 0x8C, 0x46, 0x69, 0x5C, 0x8E, 0x46, 
    0x09, 0x01, 0x19, 0x40, 0x08, 0x43, 0x50, 0x60, 0x50, 0x68, 
    0x61, 0x46, 0x49, 0x19, 0x49, 0x78, 0xC0, 0x08, 0xC0, 0x00, 
    0x49, 0x07, 0x49, 0x0F, 0x08, 0x43, 0x50, 0x60, 0x71, 0x46, 
    0x08, 0x07, 0x71, 0xD5, 0xE1, 0xE0, 0x43, 0x00, 0x18, 0x18, 
    0xA7, 0x4B, 0xC0, 0x18, 0x02, 0x29, 0x29, 0xD1, 0x51, 0x68, 
    0x40, 0x78, 0x70, 0x23, 0x99, 0x43, 0x40, 0x00, 0x86, 0x46, 
    0x28, 0x5C, 0x84, 0x46, 0x00, 0x01, 0x18, 0x40, 0x08, 0x43, 
    0x50, 0x60, 0x50, 0x68, 0x71, 0x46, 0x49, 0x19, 0x49, 0x78, 
    0xC0, 0x08, 0xC0, 0x00, 0x4B, 0x07, 0x5B, 0x0F, 0x18, 0x43, 
    0x50, 0x60, 0x50, 0x68, 0x07, 0x23, 0x1B, 0x03, 0x65, 0x46, 
    0x2D, 0x03, 0x1D, 0x40, 0x98, 0x43, 0x28, 0x43, 0x50, 0x60, 
    0x50, 0x68, 0x1B, 0x09, 0x09, 0x02, 0x19, 0x40, 0x98, 0x43, 
    0x08, 0x43, 0x50, 0x60, 0x60, 0x46, 0x00, 0x07, 0x41, 0xD5, 
    0xB1, 0xE0, 0x03, 0x29, 0x3E, 0xD1, 0x51, 0x68, 0x80, 0x78, 
    0x70, 0x23, 0x99, 0x43, 0x40, 0x00, 0x86, 0x46, 0x28, 0x5C, 
    0x84, 0x46, 0x00, 0x01, 0x18, 0x40, 0x08, 0x43, 0x50, 0x60, 
    0x50, 0x68, 0x71, 0x46, 0x49, 0x19, 0x49, 0x78, 0xC0, 0x08, 
    0xC0, 0x00, 0x4B, 0x07, 0x5B, 0x0F, 0x18, 0x43, 0x50, 0x60, 
    0x50, 0x68, 0x07, 0x23, 0x1B, 0x03, 0x65, 0x46, 0x2D, 0x03, 
    0x98, 0x43, 0x1D, 0x40, 0x00, 0xE0, 0x0C, 0xE0, 0x28, 0x43, 
    0x50, 0x60, 0x50, 0x68, 0x1B, 0x09, 0x09, 0x02, 0x19, 0x40, 
    0x98, 0x43, 0x08, 0x43, 0x50, 0x60, 0x60, 0x46, 0x00, 0x07, 
    0x13, 0xD5, 0x83, 0xE0, 0x05, 0x99, 0x00, 0x29, 0xFA, 0xD0, 
    0xA3, 0x00, 0x00, 0x00, 0xF4, 0x71, 0xD1, 0x77, 0x49, 0x63, 
    0x46, 0xC9, 0x5C, 0x77, 0x4B, 0x00, 0x29, 0x1D, 0xD1, 0x50, 
    0x68, 0x70, 0x21, 0x88, 0x43, 0x03, 0x99, 0x59, 0x5C, 0x49, 
    0x00, 0x8C, 0x46, 0x69, 0x5C, 0x8E, 0x46, 0x00, 0xE0, 0x72, 
    0xE0, 0x09, 0x01, 0x70, 0x23, 0x19, 0x40, 0x08, 0x43, 0x50, 
    0x60, 0x50, 0x68, 0x61, 0x46, 0x49, 0x19, 0x49, 0x78, 0xC0, 
    0x08, 0xC0, 0x00, 0x49, 0x07, 0x49, 0x0F, 0x08, 0x43, 0x50, 
    0x60, 0x71, 0x46, 0x08, 0x07, 0x60, 0xD5, 0x5C, 0xE0, 0x43, 
    0x00, 0x18, 0x18, 0x66, 0x4B, 0xC0, 0x18, 0x02, 0x29, 0x29, 
    0xD1, 0x51, 0x68, 0x40, 0x78, 0x70, 0x23, 0x99, 0x43, 0x40, 
    0x00, 0x86, 0x46, 0x28, 0x5C, 0x84, 0x46, 0x00, 0x01, 0x18, 
    0x40, 0x08, 0x43, 0x50, 0x60, 0x50, 0x68, 0x71, 0x46, 0x49, 
    0x19, 0x49, 0x78, 0xC0, 0x08, 0xC0, 0x00, 0x4B, 0x07, 0x5B, 
    0x0F, 0x18, 0x43, 0x50, 0x60, 0x50, 0x68, 0x07, 0x23, 0x1B, 
    0x03, 0x65, 0x46, 0x2D, 0x03, 0x1D, 0x40, 0x98, 0x43, 0x28, 
    0x43, 0x50, 0x60, 0x50, 0x68, 0x1B, 0x09, 0x09, 0x02, 0x19, 
    0x40, 0x98, 0x43, 0x08, 0x43, 0x50, 0x60, 0x60, 0x46, 0x00, 
    0x07, 0x30, 0xD5, 0x2C, 0xE0, 0x03, 0x29, 0x2D, 0xD1, 0x51, 
    0x68, 0x80, 0x78, 0x70, 0x23, 0x99, 0x43, 0x40, 0x00, 0x86, 
    0x46, 0x28, 0x5C, 0x84, 0x46, 0x00, 0x01, 0x18, 0x40, 0x08, 
    0x43, 0x50, 0x60, 0x50, 0x68, 0x71, 0x46, 0x49, 0x19, 0x49, 
    0x78, 0xC0, 0x08, 0xC0, 0x00, 0x4B, 0x07, 0x5B, 0x0F, 0x18, 
    0x43, 0x50, 0x60, 0x50, 0x68, 0x07, 0x23, 0x1B, 0x03, 0x98, 
    0x43, 0x65, 0x46, 0x00, 0xE0, 0x11, 0xE0, 0x2D, 0x03, 0x1D, 
    0x40, 0x28, 0x43, 0x50, 0x60, 0x50, 0x68, 0x1B, 0x09, 0xFA, 
    0xC4, 0xA4, 0x00, 0x00, 0x00, 0xF4, 0x09, 0x02, 0x19, 0x40, 
    0x98, 0x43, 0x08, 0x43, 0x50, 0x60, 0x60, 0x46, 0x00, 0x07, 
    0x02, 0xD5, 0xA0, 0x6A, 0x40, 0x02, 0x46, 0x0F, 0x18, 0xE0, 
    0x37, 0x49, 0x08, 0x5C, 0x40, 0x00, 0x29, 0x5C, 0x0B, 0x07, 
    0x02, 0xD5, 0xA3, 0x6A, 0x5B, 0x02, 0x5E, 0x0F, 0x53, 0x68, 
    0x70, 0x24, 0x09, 0x01, 0x21, 0x40, 0xA3, 0x43, 0x19, 0x43, 
    0x51, 0x60, 0x51, 0x68, 0x40, 0x19, 0x40, 0x78, 0xC9, 0x08, 
    0xC9, 0x00, 0x40, 0x07, 0x40, 0x0F, 0x08, 0x43, 0x50, 0x60, 
    0x22, 0x48, 0x09, 0x21, 0x89, 0x01, 0x41, 0x18, 0x49, 0x68, 
    0x09, 0x04, 0x09, 0x0C, 0xFF, 0x39, 0x0D, 0x39, 0x19, 0xD1, 
    0xFF, 0x21, 0x02, 0x1C, 0xFF, 0x32, 0x69, 0x31, 0x49, 0x32, 
    0x13, 0x68, 0x24, 0x4C, 0x23, 0x43, 0x13, 0x60, 0x23, 0x4A, 
    0x24, 0x4B, 0x1A, 0x61, 0x03, 0x1C, 0xFF, 0x33, 0x23, 0x4A, 
    0x81, 0x33, 0x9A, 0x60, 0xFA, 0x6A, 0xFF, 0x23, 0x1B, 0x02, 
    0x9A, 0x43, 0x0D, 0x23, 0x9B, 0x02, 0xD2, 0x18, 0xFA, 0x62, 
    0x07, 0xE0, 0x00, 0x9A, 0x1C, 0x21, 0x89, 0x1B, 0x92, 0x00, 
    0x89, 0x18, 0x1B, 0x4A, 0x49, 0x00, 0x51, 0x5A, 0xC0, 0x30, 
    0x82, 0x6A, 0x1A, 0x4B, 0x09, 0x02, 0x1A, 0x40, 0xDB, 0x43, 
    0x19, 0x40, 0x11, 0x43, 0x81, 0x62, 0x06, 0xB0, 0xF0, 0xBC, 
    0x08, 0xBC, 0x18, 0x47, 0x00, 0x22, 0x83, 0x5C, 0x8B, 0x54, 
    0x13, 0x1C, 0xC3, 0x5C, 0x01, 0x32, 0xFF, 0x2B, 0xF8, 0xD1, 
    0x10, 0x1C, 0x70, 0x47, 0x18, 0xE6, 0x04, 0x20, 0x00, 0x00, 
    0x00, 0xBC, 0xAC, 0x00, 0x00, 0x00, 0x59, 0x32, 0x00, 0x00, 
    0x14, 0x33, 0x00, 0x00, 0xC9, 0x31, 0x00, 0x00, 0x00, 0x01, 
    0x00, 0xBC, 0xDC, 0xE6, 0x04, 0x20, 0xF8, 0x31, 0x00, 0x00, 
    0xFA, 0xB8, 0xA5, 0x00, 0x00, 0x00, 0xF4, 0x28, 0x32, 0x00, 
    0x00, 0xCA, 0x31, 0x00, 0x00, 0x80, 0x02, 0x00, 0x06, 0xC4, 
    0xC3, 0x01, 0x00, 0x40, 0x03, 0x00, 0xBC, 0x20, 0x80, 0x02, 
    0x00, 0x18, 0xE5, 0x04, 0x20, 0xFF, 0x00, 0xFC, 0xFF, 0x3C, 
    0x48, 0x01, 0x1C, 0xFF, 0x31, 0xC1, 0x31, 0x4A, 0x68, 0x3B, 
    0x4B, 0x1A, 0x40, 0x4B, 0x23, 0x5B, 0x04, 0xD2, 0x18, 0x4A, 
    0x60, 0xFF, 0x30, 0x81, 0x30, 0x41, 0x6B, 0x09, 0x0A, 0x09, 
    0x02, 0x0C, 0x31, 0x41, 0x63, 0x41, 0x68, 0x49, 0x01, 0x03, 
    0x22, 0xD2, 0x06, 0x49, 0x09, 0x89, 0x18, 0x41, 0x60, 0x70, 
    0x47, 0xF8, 0xB5, 0x2F, 0x4F, 0x00, 0x24, 0x00, 0x25, 0xC0, 
    0x37, 0x00, 0x94, 0x78, 0x69, 0x01, 0x21, 0x49, 0x03, 0x88, 
    0x43, 0x78, 0x61, 0x2D, 0x48, 0x2B, 0x4E, 0x80, 0x79, 0x2C, 
    0x4A, 0x80, 0x06, 0x15, 0xD5, 0x68, 0x1C, 0x00, 0x06, 0x00, 
    0x0E, 0x29, 0x1C, 0x05, 0x1C, 0x48, 0x00, 0x14, 0x52, 0x0B, 
    0x2D, 0x07, 0xD0, 0x20, 0x1C, 0x30, 0x5C, 0x01, 0x34, 0xFF, 
    0x28, 0xFA, 0xD1, 0x01, 0x34, 0x0B, 0x2D, 0xEE, 0xD3, 0x30, 
    0x19, 0x10, 0x38, 0xC0, 0x7B, 0x00, 0x90, 0x10, 0xE0, 0x20, 
    0x49, 0x68, 0x00, 0x0C, 0x52, 0x68, 0x1C, 0x00, 0x06, 0x00, 
    0x0E, 0x31, 0x19, 0x2A, 0x1C, 0x05, 0x1C, 0x90, 0x00, 0x1C, 
    0x4A, 0x10, 0x58, 0xFF, 0xF7, 0x85, 0xFF, 0x04, 0x19, 0x0B, 
    0x2D, 0xEE, 0xD3, 0x78, 0x69, 0x01, 0x21, 0x49, 0x03, 0x08, 
    0x43, 0x78, 0x61, 0xFF, 0xF7, 0xA7, 0xFF, 0x00, 0x98, 0xF8, 
    0xBC, 0x08, 0xBC, 0x18, 0x47, 0x14, 0x48, 0x01, 0x22, 0x01, 
    0x78, 0x92, 0x04, 0x53, 0x00, 0x12, 0x48, 0x00, 0x29, 0xC1, 
    0x6A, 0x0D, 0xD0, 0x19, 0x43, 0xC1, 0x62, 0xC1, 0x6A, 0x13, 
    0x01, 0xFA, 0xAC, 0xA6, 0x00, 0x00, 0x00, 0xF4, 0x19, 0x43, 
    0xC1, 0x62, 0xC1, 0x6A, 0x11, 0x43, 0xC1, 0x62, 0xC1, 0x6A, 
    0x03, 0x22, 0x12, 0x05, 0x11, 0x43, 0x03, 0xE0, 0x99, 0x43, 
    0xC1, 0x62, 0xC1, 0x6A, 0x91, 0x43, 0xC1, 0x62, 0x70, 0x47, 
    0x00, 0x00, 0x00, 0xBC, 0xFF, 0xFF, 0x00, 0xE0, 0x00, 0x04, 
    0x00, 0xBC, 0xAC, 0x00, 0x00, 0x00, 0xE0, 0x31, 0x00, 0x00, 
    0xFC, 0xE6, 0x04, 0x20, 0x5B, 0x32, 0x00, 0x00, 0x80, 0x01, 
    0x00, 0xBC, 0xFE, 0xB5, 0x8E, 0x48, 0x01, 0x27, 0x80, 0x79, 
    0x08, 0x21, 0x08, 0x40, 0x71, 0xD0, 0x04, 0x20, 0x00, 0xF0, 
    0x68, 0xFC, 0x8A, 0x48, 0x04, 0x1C, 0xC0, 0x34, 0x61, 0x69, 
    0xBA, 0x03, 0x11, 0x43, 0x61, 0x61, 0x61, 0x69, 0x53, 0x00, 
    0x19, 0x43, 0x61, 0x61, 0x61, 0x69, 0x91, 0x43, 0x61, 0x61, 
    0xA1, 0x6A, 0xD2, 0x03, 0x91, 0x43, 0xA1, 0x62, 0x05, 0x1C, 
    0xFF, 0x35, 0x81, 0x35, 0xE9, 0x6A, 0xD2, 0x0A, 0x91, 0x43, 
    0xE9, 0x62, 0x06, 0x1C, 0xFF, 0x36, 0x41, 0x36, 0x71, 0x6B, 
    0x52, 0x03, 0x11, 0x43, 0x71, 0x63, 0x71, 0x6B, 0x53, 0x0A, 
    0x19, 0x43, 0x71, 0x63, 0x71, 0x6B, 0xD2, 0x0C, 0x11, 0x43, 
    0x71, 0x63, 0x71, 0x6B, 0x57, 0x08, 0x39, 0x43, 0x71, 0x63, 
    0xA1, 0x69, 0x99, 0x43, 0xA1, 0x61, 0xA1, 0x69, 0x11, 0x43, 
    0xA1, 0x61, 0xA1, 0x69, 0x39, 0x43, 0xA1, 0x61, 0x61, 0x69, 
    0x52, 0x00, 0x91, 0x43, 0x61, 0x61, 0xFF, 0x30, 0xC1, 0x30, 
    0x02, 0x90, 0x40, 0x69, 0x80, 0x00, 0x80, 0x08, 0x51, 0x04, 
    0x40, 0x18, 0x02, 0x99, 0x48, 0x61, 0x28, 0x6B, 0x40, 0x09, 
    0x40, 0x01, 0x28, 0x63, 0x28, 0x6B, 0x1F, 0x21, 0x09, 0x02, 
    0x88, 0x43, 0x28, 0x63, 0x28, 0x6B, 0x91, 0x00, 0x08, 0x43, 
    0x28, 0x63, 0xFA, 0xA0, 0xA7, 0x00, 0x00, 0x00, 0xF4, 0xA0, 
    0x69, 0x09, 0x04, 0x08, 0x43, 0xA0, 0x61, 0x01, 0x22, 0x05, 
    0x21, 0x03, 0x20, 0x00, 0xF0, 0x17, 0xFC, 0xA1, 0x69, 0x49, 
    0x00, 0x49, 0x08, 0xA1, 0x61, 0x00, 0x28, 0x66, 0xDB, 0x00, 
    0x20, 0x01, 0x90, 0x28, 0x6B, 0x01, 0x21, 0xC9, 0x03, 0x88, 
    0x43, 0x28, 0x63, 0x28, 0x6B, 0x03, 0x21, 0x89, 0x05, 0x88, 
    0x43, 0x01, 0x21, 0x89, 0x05, 0x40, 0x18, 0x28, 0x63, 0x00, 
    0xE0, 0x9E, 0xE0, 0x28, 0x6B, 0x40, 0x09, 0x40, 0x01, 0x28, 
    0x63, 0x28, 0x6B, 0x1F, 0x21, 0x09, 0x02, 0x88, 0x43, 0x28, 
    0x63, 0xA0, 0x69, 0xCF, 0x05, 0x38, 0x43, 0xA0, 0x61, 0xFF, 
    0x20, 0x2D, 0x30, 0x00, 0xF0, 0xF7, 0xFB, 0xA0, 0x69, 0xB8, 
    0x43, 0xA0, 0x61, 0xA8, 0x6A, 0x00, 0x05, 0xA9, 0x6A, 0x00, 
    0x0D, 0x09, 0x01, 0x09, 0x0D, 0x42, 0x42, 0x00, 0x28, 0x00, 
    0xDB, 0x02, 0x1C, 0x48, 0x42, 0x00, 0x29, 0x00, 0xDB, 0x08, 
    0x1C, 0x02, 0x99, 0x48, 0x69, 0x03, 0x21, 0x89, 0x07, 0x08, 
    0x43, 0x02, 0x99, 0x48, 0x61, 0x28, 0x6B, 0x01, 0x21, 0xC9, 
    0x03, 0x08, 0x43, 0x28, 0x63, 0xA0, 0x69, 0x0F, 0x04, 0x38, 
    0x43, 0xA0, 0x61, 0x02, 0x22, 0x05, 0x21, 0x01, 0x20, 0x00, 
    0xF0, 0xC9, 0xFB, 0xA1, 0x69, 0xB9, 0x43, 0xA1, 0x61, 0x00, 
    0x28, 0x1A, 0xDA, 0x01, 0x98, 0x00, 0x27, 0x01, 0x30, 0x00, 
    0x06, 0x00, 0x0E, 0x01, 0x90, 0x02, 0x28, 0xAC, 0xD3, 0x01, 
    0x2F, 0x3A, 0xD1, 0x28, 0x6B, 0x01, 0x21, 0xC9, 0x03, 0x88, 
    0x43, 0x28, 0x63, 0x28, 0x6B, 0x03, 0x21, 0x89, 0x05, 0x88, 
    0x43, 0x01, 0x21, 0xC9, 0x05, 0x40, 0x18, 0x28, 0x63, 0x00, 
    0x20, 0x01, 0x90, 0x02, 0xE0, 0x28, 0xE0, 0x01, 0x27, 0xEC, 
    0xE7, 0xA0, 0x69, 0xFA, 0x94, 0xA8, 0x00, 0x00, 0x00, 0xF4, 
    0x01, 0x21, 0xC9, 0x07, 0x08, 0x43, 0xA0, 0x61, 0xFF, 0x20, 
    0x2D, 0x30, 0x00, 0xF0, 0xA6, 0xFB, 0xA0, 0x69, 0x40, 0x00, 
    0x40, 0x08, 0xA0, 0x61, 0x01, 0x98, 0x01, 0x30, 0x00, 0x06, 
    0x00, 0x0E, 0x01, 0x90, 0x02, 0x28, 0xEB, 0xD3, 0xA8, 0x6A, 
    0x00, 0x05, 0xA9, 0x6A, 0x00, 0x0D, 0x09, 0x01, 0x09, 0x0D, 
    0x42, 0x42, 0x00, 0x28, 0x00, 0xDB, 0x02, 0x1C, 0x64, 0x2A, 
    0x00, 0xDA, 0x00, 0x27, 0x48, 0x42, 0x00, 0x29, 0x00, 0xDB, 
    0x08, 0x1C, 0x64, 0x28, 0x00, 0xDA, 0x00, 0x27, 0xA0, 0x69, 
    0x01, 0x23, 0x9B, 0x05, 0x18, 0x43, 0xA0, 0x61, 0xA0, 0x69, 
    0x99, 0x0A, 0x88, 0x43, 0xA0, 0x61, 0xA0, 0x69, 0x4A, 0x08, 
    0x90, 0x43, 0xA0, 0x61, 0x70, 0x6B, 0x40, 0x00, 0x40, 0x08, 
    0x70, 0x63, 0x70, 0x6B, 0x98, 0x43, 0x70, 0x63, 0x70, 0x6B, 
    0x88, 0x43, 0x70, 0x63, 0x70, 0x6B, 0x90, 0x43, 0x70, 0x63, 
    0x60, 0x69, 0x4A, 0x00, 0x10, 0x43, 0x60, 0x61, 0x38, 0x1C, 
    0xFE, 0xBC, 0x08, 0xBC, 0x18, 0x47, 0x00, 0x00, 0xAC, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0xBC, 0x02, 0x48, 0x41, 0x69, 
    0x49, 0x01, 0x89, 0x0F, 0xFB, 0xD1, 0x70, 0x47, 0xC0, 0x00, 
    0x00, 0xBC, 0xF8, 0xB5, 0x32, 0x4C, 0x20, 0x78, 0x02, 0x30, 
    0x20, 0x70, 0x01, 0x20, 0x00, 0xF0, 0x58, 0xFB, 0x2F, 0x4D, 
    0x0E, 0x23, 0x29, 0x78, 0x2F, 0x4E, 0x59, 0x43, 0x00, 0x23, 
    0xE2, 0x56, 0x89, 0x19, 0x89, 0x18, 0x48, 0x70, 0x00, 0x20, 
    0x00, 0xF0, 0x4B, 0xFB, 0x29, 0x78, 0x0E, 0x22, 0x00, 0x23, 
    0xE5, 0x56, 0x4A, 0x43, 0x92, 0x19, 0x52, 0x19, 0x90, 0x70, 
    0x0C, 0x20, 0x48, 0x43, 0x26, 0x49, 0x01, 0x25, 0x41, 0x18, 
    0x4A, 0x78, 0x60, 0x68, 0xFA, 0x88, 0xA9, 0x00, 0x00, 0x00, 
    0xF4, 0x6D, 0x04, 0x13, 0x1A, 0x01, 0x2B, 0x25, 0x4C, 0x22, 
    0x4E, 0x23, 0x4F, 0x0F, 0xD9, 0x08, 0x18, 0xC0, 0x78, 0x00, 
    0xF0, 0x39, 0xFB, 0x1B, 0x49, 0x38, 0x68, 0x49, 0x68, 0x48, 
    0x43, 0x31, 0x68, 0x40, 0x18, 0x40, 0x04, 0x40, 0x0C, 0x40, 
    0x19, 0x20, 0x64, 0x0A, 0x20, 0x0A, 0xE0, 0x82, 0x42, 0x0B, 
    0xD0, 0x39, 0x68, 0x41, 0x43, 0x30, 0x68, 0x08, 0x18, 0x40, 
    0x04, 0x40, 0x0C, 0x40, 0x19, 0x20, 0x64, 0x05, 0x20, 0x00, 
    0xF0, 0x00, 0xFB, 0x15, 0xE0, 0x01, 0x20, 0x40, 0x02, 0x20, 
    0x18, 0x00, 0x68, 0xC0, 0x05, 0x01, 0xD4, 0x00, 0xF0, 0x1F, 
    0xFB, 0xA0, 0x6C, 0x10, 0x21, 0x88, 0x43, 0xA0, 0x64, 0x20, 
    0x6E, 0x88, 0x43, 0x20, 0x66, 0x06, 0x49, 0x00, 0x20, 0x48, 
    0x60, 0xFF, 0x20, 0x08, 0x70, 0x00, 0xF0, 0x19, 0xFB, 0x03, 
    0x49, 0x48, 0x68, 0x01, 0x30, 0x48, 0x60, 0xF8, 0xBC, 0x08, 
    0xBC, 0x18, 0x47, 0xB4, 0xB1, 0x00, 0x00, 0x59, 0x32, 0x00, 
    0x00, 0x6C, 0x33, 0x00, 0x00, 0x88, 0x33, 0x00, 0x00, 0xF0, 
    0x05, 0x00, 0x00, 0xF4, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0xBC, 0x80, 0xB5, 0x0A, 0x20, 0x00, 0xF0, 0xD0, 0xFA, 0x80, 
    0xBC, 0x08, 0xBC, 0x18, 0x47, 0x00, 0x00, 0xF8, 0xB5, 0x31, 
    0x49, 0x07, 0x1C, 0x0C, 0x1C, 0x0D, 0x1C, 0x3C, 0x35, 0x40, 
    0x34, 0x00, 0x26, 0x03, 0x28, 0x06, 0xD0, 0x07, 0xDC, 0x00, 
    0x2F, 0x43, 0xD0, 0x01, 0x2F, 0x01, 0xD0, 0x02, 0x2F, 0x4C, 
    0xD1, 0x02, 0x26, 0x4B, 0xE0, 0x11, 0x2F, 0x03, 0xD0, 0x12, 
    0x2F, 0x01, 0xD0, 0x13, 0x2F, 0x44, 0xD1, 0x28, 0x68, 0x01, 
    0x21, 0xC9, 0x02, 0x08, 0x43, 0x28, 0x60, 0x20, 0x68, 0x88, 
    0x43, 0x20, 0x60, 0x21, 0x48, 0xFA, 0x7C, 0xAA, 0x00, 0x00, 
    0x00, 0xF4, 0x28, 0x30, 0x01, 0x68, 0x01, 0x23, 0x5B, 0x02, 
    0x19, 0x43, 0x01, 0x60, 0x1D, 0x49, 0x20, 0x31, 0x0A, 0x68, 
    0x9A, 0x43, 0x0A, 0x60, 0x2B, 0x68, 0x01, 0x22, 0x92, 0x02, 
    0x13, 0x43, 0x2B, 0x60, 0x23, 0x68, 0x93, 0x43, 0x23, 0x60, 
    0x03, 0x68, 0x13, 0x43, 0x03, 0x60, 0x0B, 0x68, 0x93, 0x43, 
    0x0B, 0x60, 0x01, 0x68, 0x92, 0x00, 0x91, 0x43, 0x01, 0x60, 
    0x08, 0x30, 0x01, 0x68, 0x11, 0x43, 0x01, 0x60, 0x11, 0x48, 
    0xD3, 0x08, 0xC0, 0x18, 0x01, 0x68, 0x99, 0x43, 0x01, 0x60, 
    0x01, 0x68, 0x02, 0x22, 0x91, 0x43, 0x01, 0x60, 0x0D, 0x21, 
    0x41, 0x60, 0x81, 0x60, 0x09, 0xE0, 0x00, 0xF0, 0xB1, 0xFA, 
    0x28, 0x68, 0x07, 0x21, 0x89, 0x02, 0x88, 0x43, 0x28, 0x60, 
    0x20, 0x68, 0x88, 0x43, 0x20, 0x60, 0x06, 0x48, 0x07, 0x60, 
    0x00, 0xE0, 0x01, 0x26, 0x30, 0x1C, 0xF8, 0xBC, 0x08, 0xBC, 
    0x18, 0x47, 0x00, 0x00, 0x00, 0x00, 0x00, 0x9F, 0x00, 0x00, 
    0x00, 0xBC, 0x60, 0x32, 0x00, 0x00, 0xF8, 0xB5, 0x55, 0x4C, 
    0x20, 0x69, 0x06, 0x04, 0x54, 0x48, 0x36, 0x0C, 0x01, 0x78, 
    0x06, 0x20, 0x53, 0x4D, 0xB2, 0x07, 0x48, 0x43, 0x43, 0x19, 
    0x92, 0x0F, 0xDA, 0x70, 0x72, 0x07, 0xD2, 0x0F, 0x50, 0x4F, 
    0x1A, 0x71, 0x3A, 0x78, 0x03, 0x2A, 0x01, 0xD0, 0x04, 0x2A, 
    0x02, 0xD1, 0x36, 0x06, 0xF6, 0x0E, 0x01, 0xE0, 0xF6, 0x04, 
    0xB6, 0x0D, 0x2E, 0x52, 0x02, 0x2A, 0x01, 0xD1, 0x02, 0x26, 
    0x00, 0xE0, 0x00, 0x26, 0x9E, 0x70, 0x08, 0x2A, 0x02, 0xD1, 
    0x46, 0x4B, 0x03, 0x22, 0x1A, 0x70, 0x34, 0x23, 0x45, 0x4A, 
    0x59, 0x43, 0x51, 0x58, 0x49, 0x05, 0x89, 0x0F, 0x02, 0x29, 
    0x06, 0xD1, 0x42, 0x49, 0x09, 0x78, 0xFA, 0x70, 0xAB, 0x00, 
    0x00, 0x00, 0xF4, 0x00, 0x29, 0x02, 0xD0, 0x29, 0x5A, 0x02, 
    0x31, 0x29, 0x52, 0x00, 0xF0, 0x69, 0xFA, 0x3A, 0x49, 0x06, 
    0x23, 0x09, 0x78, 0x01, 0x20, 0x59, 0x43, 0x49, 0x19, 0x48, 
    0x71, 0x00, 0xF0, 0x68, 0xFA, 0x35, 0x48, 0x3A, 0x4E, 0x00, 
    0x78, 0x3A, 0x4F, 0xC2, 0x00, 0xB1, 0x58, 0x00, 0x29, 0x04, 
    0xD1, 0x06, 0x23, 0x43, 0x43, 0xEB, 0x5A, 0x00, 0x2B, 0x20, 
    0xD1, 0x92, 0x19, 0x12, 0x79, 0x01, 0x2A, 0x1C, 0xD0, 0x06, 
    0x23, 0x58, 0x43, 0x28, 0x5A, 0x32, 0x4A, 0x10, 0x80, 0xFF, 
    0x22, 0x59, 0x32, 0x90, 0x42, 0x0B, 0xD9, 0x2A, 0x48, 0x01, 
    0x23, 0x00, 0x78, 0x00, 0xF0, 0x51, 0xFA, 0x2D, 0x4A, 0x10, 
    0x88, 0xFF, 0x38, 0x59, 0x38, 0x10, 0x80, 0x2B, 0x48, 0x06, 
    0xE0, 0x00, 0x23, 0x02, 0x1C, 0x23, 0x48, 0x00, 0x78, 0x00, 
    0xF0, 0x44, 0xFA, 0x28, 0x48, 0x38, 0x60, 0x00, 0xF0, 0x48, 
    0xFA, 0x1D, 0x48, 0x06, 0x21, 0x00, 0x78, 0x41, 0x43, 0x69, 
    0x5A, 0x00, 0x29, 0x0C, 0xD1, 0xC1, 0x00, 0x89, 0x19, 0x09, 
    0x79, 0x01, 0x29, 0x07, 0xD0, 0xE0, 0x68, 0x08, 0x21, 0x88, 
    0x43, 0xE0, 0x60, 0x10, 0x20, 0x60, 0x61, 0x1E, 0x48, 0x20, 
    0xE0, 0xC1, 0x00, 0x72, 0x58, 0x00, 0x2A, 0x03, 0xD0, 0x8A, 
    0x19, 0x12, 0x79, 0x01, 0x2A, 0x19, 0xD1, 0x89, 0x19, 0x0B, 
    0x79, 0x1A, 0x49, 0x19, 0x4A, 0x01, 0x2B, 0x01, 0xD1, 0x04, 
    0x23, 0x00, 0xE0, 0x01, 0x23, 0x85, 0x00, 0x6D, 0x18, 0x6B, 
    0x70, 0x13, 0x70, 0x00, 0x23, 0x80, 0x00, 0x0B, 0x54, 0x14, 
    0x48, 0xA0, 0x61, 0x64, 0x20, 0x60, 0x61, 0x00, 0xF0, 0x1E, 
    0xFA, 0x00, 0xF0, 0x24, 0xFA, 0x11, 0x48, 0x38, 0x60, 0xF8, 
    0xBC, 0x08, 0xBC, 0x18, 0x47, 0x00, 0x00, 0xFA, 0x64, 0xAC, 
    0x00, 0x00, 0x00, 0xF4, 0x80, 0x00, 0x00, 0xBC, 0x59, 0x32, 
    0x00, 0x00, 0x08, 0x33, 0x00, 0x00, 0xBC, 0x33, 0x00, 0x00, 
    0x78, 0x32, 0x00, 0x00, 0xC8, 0x33, 0x00, 0x00, 0xA8, 0x33, 
    0x00, 0x00, 0x88, 0x04, 0x00, 0x00, 0xC0, 0x33, 0x00, 0x00, 
    0x3F, 0x78, 0x00, 0x20, 0x29, 0x78, 0x00, 0x20, 0x43, 0x77, 
    0x00, 0x20, 0xBD, 0x33, 0x00, 0x00, 0x68, 0x32, 0x00, 0x00, 
    0x0F, 0x00, 0x01, 0x00, 0x35, 0x77, 0x00, 0x20, 0x10, 0xB5, 
    0x0A, 0x4C, 0x0C, 0x23, 0x20, 0x78, 0x09, 0x49, 0x58, 0x43, 
    0x40, 0x18, 0x00, 0x7A, 0x01, 0x28, 0x07, 0xD1, 0x03, 0x20, 
    0x00, 0xF0, 0xA1, 0xF9, 0x21, 0x78, 0x0E, 0x23, 0x05, 0x4A, 
    0x59, 0x43, 0x50, 0x54, 0x10, 0xBC, 0x08, 0xBC, 0x18, 0x47, 
    0x00, 0x00, 0x59, 0x32, 0x00, 0x00, 0x88, 0x33, 0x00, 0x00, 
    0x6C, 0x33, 0x00, 0x00, 0x10, 0x4B, 0x10, 0xB4, 0x1A, 0x6A, 
    0x58, 0x6A, 0x99, 0x6B, 0x5C, 0x6C, 0x1C, 0x6A, 0x94, 0x42, 
    0x03, 0xD2, 0x58, 0x6A, 0x01, 0x38, 0x40, 0x01, 0x40, 0x09, 
    0x81, 0x42, 0x05, 0xD3, 0x88, 0x42, 0x0E, 0xD2, 0x09, 0x4C, 
    0x09, 0x1A, 0xA1, 0x42, 0x0A, 0xD9, 0x99, 0x6B, 0x00, 0x21, 
    0x08, 0x43, 0x98, 0x63, 0x58, 0x6C, 0x80, 0x0B, 0x80, 0x03, 
    0x91, 0x04, 0x89, 0x0C, 0x08, 0x43, 0x58, 0x64, 0x10, 0xBC, 
    0x70, 0x47, 0x00, 0x00, 0x00, 0xBC, 0xFF, 0xFF, 0xFF, 0x03, 
    0x01, 0x21, 0x28, 0x28, 0x00, 0xD1, 0x00, 0x21, 0x03, 0x48, 
    0x0C, 0x23, 0x00, 0x78, 0x03, 0x4A, 0x58, 0x43, 0x80, 0x18, 
    0x01, 0x72, 0x70, 0x47, 0x84, 0x04, 0x00, 0x00, 0x88, 0x33, 
    0x00, 0x00, 0xFF, 0xB5, 0x16, 0x1C, 0x00, 0x24, 0x00, 0x28, 
    0x87, 0xB0, 0x01, 0xD1, 0x5F, 0x48, 0x04, 0x70, 0xFA, 0x58, 
    0xAD, 0x00, 0x00, 0x00, 0xF4, 0x5F, 0x48, 0x04, 0x72, 0x5F, 
    0x48, 0x44, 0x72, 0x5F, 0x48, 0x00, 0xF0, 0xA5, 0xF9, 0x5F, 
    0x48, 0x01, 0x27, 0x07, 0x70, 0x5E, 0x48, 0x01, 0x1C, 0x34, 
    0x31, 0x0A, 0x68, 0x50, 0x23, 0x9A, 0x43, 0x0A, 0x60, 0x0A, 
    0x68, 0x7B, 0x02, 0x9A, 0x43, 0x0A, 0x60, 0x5A, 0x49, 0x5B, 
    0x4D, 0x0C, 0x70, 0x59, 0x49, 0x0C, 0x70, 0x29, 0x79, 0x49, 
    0x06, 0x49, 0x0F, 0x02, 0x29, 0x4B, 0xD1, 0x30, 0x30, 0x02, 
    0x68, 0xC9, 0x01, 0x0A, 0x43, 0x02, 0x60, 0x51, 0x4C, 0x28, 
    0x34, 0x20, 0x68, 0x88, 0x43, 0x20, 0x60, 0x00, 0xF0, 0x89, 
    0xF9, 0x00, 0x28, 0x04, 0xD0, 0x00, 0xF0, 0x8D, 0xF9, 0x50, 
    0x48, 0x07, 0x70, 0x04, 0xE0, 0x00, 0xF0, 0x90, 0xF9, 0x4D, 
    0x49, 0x02, 0x20, 0x08, 0x70, 0x02, 0x22, 0x08, 0x21, 0x00, 
    0x20, 0x00, 0xF0, 0x90, 0xF9, 0x00, 0x23, 0x01, 0x22, 0x38, 
    0x20, 0x49, 0x49, 0x00, 0xF0, 0x92, 0xF9, 0x38, 0x20, 0x00, 
    0xF0, 0x95, 0xF9, 0x20, 0x68, 0x01, 0x23, 0x5B, 0x02, 0x18, 
    0x43, 0x20, 0x60, 0x00, 0x20, 0x00, 0xF0, 0x93, 0xF9, 0x43, 
    0x4C, 0xA0, 0x6A, 0x80, 0x06, 0x01, 0xD5, 0x00, 0xF0, 0x69, 
    0xF9, 0x41, 0x48, 0x02, 0x22, 0x07, 0x21, 0x07, 0x70, 0x00, 
    0x20, 0x00, 0xF0, 0x72, 0xF9, 0xA0, 0x6A, 0xC0, 0x07, 0x0D, 
    0xD5, 0x30, 0x48, 0x00, 0x78, 0x00, 0x28, 0x09, 0xD1, 0x00, 
    0x22, 0x07, 0x21, 0x00, 0xF0, 0x67, 0xF9, 0x37, 0x20, 0x00, 
    0xF0, 0x80, 0xF9, 0x37, 0x20, 0x00, 0xF0, 0x6F, 0xF9, 0x29, 
    0x79, 0x30, 0x48, 0x49, 0x06, 0x49, 0x0F, 0x90, 0x38, 0x02, 
    0x29, 0x08, 0xD1, 0x40, 0x30, 0xC0, 0x79, 0x80, 0x07, 0x01, 
    0xD4, 0x24, 0x20, 0x00, 0xE0, 0x34, 0x20, 0x00, 0xF0, 0xFA, 
    0x4C, 0xAE, 0x00, 0x00, 0x00, 0xF4, 0x73, 0xF9, 0x2E, 0x4A, 
    0x2E, 0x49, 0x06, 0x92, 0x2F, 0x4A, 0x2E, 0x48, 0x05, 0x91, 
    0x2F, 0x49, 0x03, 0x92, 0x04, 0x90, 0x2E, 0x48, 0x2F, 0x4A, 
    0x02, 0x91, 0x00, 0x21, 0x01, 0x90, 0x00, 0x92, 0x2E, 0x4A, 
    0x02, 0x20, 0x2C, 0x4B, 0x00, 0xF0, 0x67, 0xF9, 0x08, 0x98, 
    0x00, 0x28, 0x15, 0xD0, 0x00, 0xF0, 0x28, 0xF9, 0x00, 0x20, 
    0x00, 0xF0, 0x67, 0xF9, 0x14, 0x4C, 0xA1, 0x1D, 0x20, 0x1C, 
    0x00, 0xF0, 0x6A, 0xF9, 0x02, 0x20, 0x20, 0x72, 0x20, 0x68, 
    0x31, 0x0A, 0x06, 0x70, 0x41, 0x70, 0x0A, 0x99, 0x81, 0x70, 
    0x04, 0x20, 0x00, 0xF0, 0x67, 0xF9, 0x02, 0xE0, 0x01, 0x20, 
    0x00, 0xF0, 0x53, 0xF9, 0x28, 0x79, 0x40, 0x06, 0x40, 0x0F, 
    0x01, 0x28, 0x01, 0xD0, 0x02, 0x28, 0x01, 0xD1, 0x00, 0xF0, 
    0x62, 0xF9, 0x01, 0x20, 0x00, 0xF0, 0x67, 0xF9, 0x00, 0x20, 
    0x00, 0xF0, 0x6C, 0xF9, 0x0B, 0xB0, 0xF0, 0xBC, 0x08, 0xBC, 
    0x18, 0x47, 0xFF, 0x01, 0x00, 0x00, 0x0C, 0x02, 0x00, 0x00, 
    0x18, 0x02, 0x00, 0x00, 0x1D, 0x05, 0x00, 0x20, 0xFC, 0x01, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x9F, 0x01, 0x02, 0x00, 0x00, 
    0x02, 0x02, 0x00, 0x00, 0xFC, 0x00, 0x00, 0x00, 0xFE, 0x01, 
    0x00, 0x00, 0xD1, 0x10, 0x00, 0x20, 0x00, 0x00, 0x00, 0x96, 
    0xFD, 0x01, 0x00, 0x00, 0x67, 0x0B, 0x00, 0x20, 0x95, 0x0B, 
    0x00, 0x20, 0xD3, 0x0B, 0x00, 0x20, 0xED, 0x0B, 0x00, 0x20, 
    0x6B, 0x0C, 0x00, 0x20, 0x81, 0x0C, 0x00, 0x20, 0x87, 0x0C, 
    0x00, 0x20, 0x0F, 0x0D, 0x00, 0x20, 0xA5, 0x0D, 0x00, 0x20, 
    0xFF, 0xF7, 0x32, 0xF9, 0x01, 0xDE, 0x00, 0x00, 0x0F, 0xB4, 
    0x00, 0xB5, 0xFF, 0xF7, 0xAB, 0xFB, 0x01, 0xBC, 0x86, 0x46, 
    0xFA, 0x40, 0xAF, 0x00, 0x00, 0x00, 0xF4, 0x0F, 0xBC, 0x22, 
    0x78, 0x09, 0xDE, 0xFF, 0xF7, 0xF3, 0xFC, 0x0B, 0xDE, 0xFF, 
    0xF7, 0x6C, 0xFD, 0x0E, 0xDE, 0x00, 0x00, 0x00, 0xB5, 0xFF, 
    0xF7, 0xA5, 0xFE, 0x01, 0xBC, 0x86, 0x46, 0x12, 0xDE, 0x01, 
    0xB4, 0xFF, 0xF7, 0xBB, 0xFE, 0x01, 0xBC, 0x04, 0x1C, 0x14, 
    0xDE, 0x01, 0xB4, 0xFF, 0xF7, 0xB5, 0xFE, 0x01, 0xBC, 0x05, 
    0x1C, 0x16, 0xDE, 0x01, 0xB4, 0xFF, 0xF7, 0xAF, 0xFE, 0x01, 
    0xBC, 0x05, 0x1C, 0x18, 0xDE, 0x0F, 0xB4, 0x00, 0xB5, 0x08, 
    0x1C, 0xFF, 0xF7, 0xCD, 0xFE, 0x01, 0xBC, 0x86, 0x46, 0x0F, 
    0xBC, 0x1F, 0x78, 0x1A, 0xDE, 0x78, 0x47, 0xC0, 0x46, 0x37, 
    0xFC, 0xFF, 0xEA, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 
    0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x5D, 0x60, 0x03, 0x20, 0x78, 
    0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 
    0xE1, 0xF5, 0xB8, 0x04, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 
    0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x6B, 0x30, 0x00, 
    0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 
    0xFF, 0x2F, 0xE1, 0x53, 0x4D, 0x00, 0x20, 0x78, 0x47, 0xC0, 
    0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x33, 
    0x98, 0x00, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 
    0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0xF3, 0x95, 0x00, 0x20, 0x78, 
    0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 
    0xE1, 0x75, 0x4F, 0x00, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 
    0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x05, 0x46, 0x00, 
    0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 
    0xFF, 0x2F, 0xE1, 0x53, 0x7C, 0x03, 0x20, 0x78, 0x47, 0xC0, 
    0x46, 0xFA, 0x34, 0xB0, 0x00, 0x00, 0x00, 0xF4, 0x00, 0xC0, 
    0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x6D, 0x5D, 0x00, 0x20, 
    0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 
    0x2F, 0xE1, 0x47, 0x56, 0x00, 0x20, 0x78, 0x47, 0xC0, 0x46, 
    0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x45, 0x7C, 
    0x03, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 
    0x1C, 0xFF, 0x2F, 0xE1, 0x91, 0x9C, 0x03, 0x20, 0x78, 0x47, 
    0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 
    0x9D, 0x3F, 0x00, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 
    0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0xF7, 0x8D, 0x03, 0x20, 
    0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 
    0x2F, 0xE1, 0x17, 0x7C, 0x03, 0x20, 0x78, 0x47, 0xC0, 0x46, 
    0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0xAD, 0x93, 
    0x03, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 
    0x1C, 0xFF, 0x2F, 0xE1, 0xCD, 0x21, 0x00, 0x20, 0x78, 0x47, 
    0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 
    0x1B, 0x0B, 0x00, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 
    0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x7D, 0x69, 0x03, 0x20, 
    0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 
    0x2F, 0xE1, 0xED, 0x02, 0x00, 0x20, 0x78, 0x47, 0xC0, 0x46, 
    0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0xCD, 0x4D, 
    0x03, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x04, 0xF0, 0x1F, 0xE5, 
    0x68, 0x46, 0x03, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x04, 0xF0, 
    0x1F, 0xE5, 0x94, 0x46, 0x03, 0x20, 0x78, 0x47, 0xC0, 0x46, 
    0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x39, 0x0B, 
    0x00, 0x20, 0x9A, 0x28, 0xB1, 0x00, 0x00, 0x00, 0x94, 0x78, 
    0x47, 0xC0, 0x46, 0x04, 0xF0, 0x1F, 0xE5, 0xE4, 0x46, 0x03, 
    0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 
    0xFF, 0x2F, 0xE1, 0x91, 0x56, 0x03, 0x20, 0x78, 0x47, 0xC0, 
    0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x8F, 
    0x18, 0x00, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 
    0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x87, 0x23, 0x00, 0x20, 0x78, 
    0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 
    0xE1, 0x9D, 0x9C, 0x00, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 
    0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x1D, 0x05, 0x00, 
    0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 
    0xFF, 0x2F, 0xE1, 0x95, 0x69, 0x03, 0x20, 0x78, 0x47, 0xC0, 
    0x46, 0x00, 0xC0, 0x9F, 0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0x6D, 
    0x20, 0x00, 0x20, 0x78, 0x47, 0xC0, 0x46, 0x00, 0xC0, 0x9F, 
    0xE5, 0x1C, 0xFF, 0x2F, 0xE1, 0xF9, 0x17, 0x00, 0x20, 0xFF, 
    0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x0A, 0xE8, 0x06, 
    0x00, 0x00, 0x00, 0x04, 0x01, 0x17, 0x0A, 0x04, 0x0A, 0x00, 
    0x00, 0x00, 0x40, 0x00, 0x04, 0x01, 0x17, 0x0A, 0x04, 0x0A, 
    0xD4, 0x00, 0x00, 0xBC, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 
    0xFA, 0x00, 0x04, 0x00, 0xBC, 0x00, 0xF4, 0x49, 0x4A, 0x09, 
    0x0A, 0x0E, 0x80, 0x14, 0x15, 0x35, 0x0D, 0x12, 0x4C, 0x80, 
    0x0C, 0x10, 0x73, 0x58, 0x77, 0x36, 0x80, 0x50, 0x5D, 0x82, 
    0x46, 0x5E, 0x82, 0x4A, 0x0A, 0x89, 0x4A, 0x0A, 0x96, 0x1E, 
    0x1D, 0x57, 0x78, 0x51, 0x84, 0x59, 0x68, 0x58, 0x84, 0x48, 
    0x80, 0x5F, 0x93, 0x1F, 0x6C, 0x72, 0x6B, 0x89, 0x2B, 0x1B, 
    0x5A, 0x23, 0x83, 0x5B, 0x56, 0x67, 0x80, 0x27, 0x8B, 0x6F, 
    0xFF, 0x3F, 0x49, 0x09, 0x4A, 0x0A, 0x2F, 0x06, 0x08, 0x11, 
    0x17, 0x38, 0x19, 0x28, 0x18, 0x37, 0x33, 0x16, 0x24, 0x2C, 
    0x32, 0x1B, 0x1A, 0x25, 0x4C, 0x80, 0x76, 0x0C, 0x10, 0x80, 
    0x50, 0x85, 0x4A, 0x0A, 0x89, 0x4A, 0x0A, 0xAA, 0x54, 0x93, 
    0x75, 0x55, 0x83, 0x52, 0x4D, 0x81, 0x4E, 0x67, 0x80, 0x27, 
    0xFF, 0x3F, 0x49, 0x4A, 0x09, 0x0A, 0x26, 0x6E, 0x2D, 0x70, 
    0x40, 0x41, 0x10, 0x4F, 0x76, 0x4C, 0x80, 0x0C, 0x87, 0x4A, 
    0x0A, 0x85, 0x42, 0x84, 0x4A, 0x0A, 0x89, 0x66, 0x6D, 0x80, 
    0x2E, 0x8B, 0x30, 0x74, 0x80, 0x69, 0x81, 0x50, 0xBA, 0x54, 
    0x93, 0x75, 0x55, 0x83, 0x52, 0x4D, 0x81, 0x4E, 0x67, 0x81, 
    0x27, 0xFF, 0x3F, 0x0E, 0x80, 0x14, 0x15, 0x35, 0x0D, 0x12, 
    0x10, 0x29, 0x34, 0x36, 0x02, 0x0F, 0x00, 0x01, 0x2D, 0x49, 
    0x4A, 0x09, 0x0A, 0x26, 0xFF, 0x3F, 0x49, 0x4A, 0x09, 0x0A, 
    0x26, 0x6E, 0x2D, 0x70, 0x40, 0x41, 0x10, 0x4F, 0x73, 0x36, 
    0x4C, 0x80, 0x0C, 0x87, 0x4A, 0x0A, 0x85, 0x42, 0x83, 0x4A, 
    0x0A, 0x8A, 0x66, 0x6D, 0x80, 0x2E, 0x8B, 0x30, 0x74, 0x80, 
    0x69, 0x80, 0x58, 0x77, 0x80, 0x50, 0x5D, 0x82, 0x46, 0x5E, 
    0xA3, 0x1E, 0x1D, 0x57, 0x78, 0x51, 0x84, 0x59, 0x68, 0x84, 
    0x48, 0xFA, 0xF4, 0x04, 0x00, 0xBC, 0x00, 0xF4, 0x80, 0x5F, 
    0x93, 0x1F, 0x6C, 0x72, 0x6B, 0x89, 0x2B, 0x1B, 0x5A, 0x23, 
    0x83, 0x5B, 0x56, 0x67, 0x80, 0x27, 0x8A, 0x6F, 0xFF, 0x3F, 
    0x34, 0x2F, 0x22, 0x3C, 0x25, 0x06, 0x08, 0x33, 0x37, 0x29, 
    0x02, 0x00, 0x01, 0x2D, 0x0F, 0x10, 0x17, 0x38, 0x19, 0x11, 
    0x28, 0x18, 0x16, 0x24, 0x2C, 0x32, 0x1B, 0x1A, 0x49, 0x4A, 
    0x09, 0x0A, 0x26, 0x67, 0x80, 0x27, 0xFF, 0x3F, 0x63, 0x88, 
    0x65, 0x62, 0xA1, 0x22, 0x2F, 0x87, 0x64, 0xFF, 0x3F, 0x49, 
    0x4A, 0x09, 0x0A, 0x26, 0x0E, 0x80, 0x14, 0x15, 0x35, 0x0D, 
    0x12, 0x36, 0x73, 0x46, 0x5D, 0x80, 0x5E, 0x83, 0x57, 0x78, 
    0x51, 0x84, 0x59, 0x58, 0x77, 0x84, 0x48, 0x5F, 0x93, 0x1F, 
    0x1E, 0x1D, 0x1B, 0x5A, 0x23, 0x83, 0x5B, 0x56, 0x8B, 0x6F, 
    0x89, 0x2F, 0x82, 0x4B, 0x81, 0x1B, 0x5B, 0x89, 0x6F, 0x89, 
    0x2F, 0x0B, 0x34, 0x3C, 0x22, 0x06, 0x08, 0x29, 0x02, 0x00, 
    0x01, 0x2D, 0x0F, 0x10, 0x17, 0x38, 0x19, 0x11, 0x18, 0x16, 
    0x24, 0x1B, 0x1A, 0x33, 0x37, 0xFF, 0x3F, 0x6E, 0x2D, 0x70, 
    0x40, 0x41, 0x10, 0x4F, 0x73, 0x36, 0x4C, 0x80, 0x0C, 0x8D, 
    0x42, 0x8E, 0x6D, 0x80, 0x2E, 0x8B, 0x30, 0x74, 0x80, 0x69, 
    0x80, 0x58, 0x77, 0x80, 0x50, 0x5D, 0x82, 0x46, 0x5E, 0xA3, 
    0x1E, 0x1D, 0x57, 0x78, 0x51, 0x84, 0x59, 0x58, 0x84, 0x48, 
    0x80, 0x5F, 0x93, 0x1F, 0x80, 0x1B, 0x5A, 0x83, 0x23, 0x5B, 
    0x56, 0x8B, 0x6F, 0x89, 0x2F, 0x82, 0x4B, 0x81, 0x1B, 0x5B, 
    0x89, 0x6F, 0x89, 0x2F, 0x81, 0x67, 0x0B, 0x27, 0xFF, 0x3F, 
    0x63, 0x32, 0x88, 0x65, 0x7C, 0xA1, 0x3C, 0x2F, 0x72, 0xFF, 
    0x3F, 0x10, 0x4C, 0x80, 0x0C, 0x50, 0xCE, 0x6F, 0x89, 0x2F, 
    0x82, 0x4B, 0x16, 0xE8, 0x05, 0x00, 0xBC, 0x00, 0x10, 0x81, 
    0x1B, 0x5B, 0x89, 0x6F, 0x89, 0x2F, 0x81, 0x67, 0x0B, 0x27, 
    0xFF, 0x3F, 0x00, 0x00, 0x00, 0x0A, 0xD4, 0x00, 0x00, 0xBC, 
    0x00, 0x04, 0x00, 0x20, 0x00, 0x00, 0x0A, 0x60, 0x00, 0x00, 
    0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x60, 0x03, 
    0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x16, 0x70, 
    0x02, 0x00, 0x21, 0x00, 0x10, 0x2C, 0x01, 0x00, 0x00, 0x14, 
    0x02, 0x00, 0x00, 0x24, 0x07, 0x00, 0x00, 0x14, 0x03, 0x00, 
    0x00, 0x0A, 0xBC, 0x00, 0x00, 0x92, 0x00, 0x04, 0x02, 0x36, 
    0x00, 0x80
};

#endif /* CSR_H4I_ENABLE_PATCH */

typedef struct
{
    CsrUint8 fwVariant;
    CsrUint8 fwVersion;
    CsrUint8 fwBuild[3];
} CsrH4iFwVersion;

#define CSR_H4I_DISABLE_PATCH

CsrUint8 *CsrH4iGetNextPatch(CsrUint8 *length, CsrH4iFwVersion *ver, CsrBool first)
{
#ifdef CSR_H4I_DISABLE_PATCH
    *length = 0;
    return NULL;
#else
    static CsrUint8 *next;
    static CsrUint32 patchLen;
    CsrUint8 *data;
    
    if (first)
    {
        next = (CsrUint8*)patch;
    }
    
    if (patchLen < sizeof(patch))
    {
        *length = *next;
        data = next + 1;
        next += *length + 1;
        patchLen = patchLen + (CsrUint32)(*length);
    }
    else
    {
        data = NULL;
        *length = 0;
    }
    return data;
#endif /* CSR_H4I_DISABLE_PATCH */
}
#endif /* CSR_IBFP_H4I_SUPPORT  */

#ifdef CSR_USE_QCA_CHIP
#ifdef CSR_BOOT_QCA_CHIP_INTERNALLY
CsrUint8 CsrQsocBaudrateMap(CsrUint32 baud)
{
    switch (baud)
    {
        case 115200:
            return 0x00;

        case 57600:
            return 0x01;

        case 38400:
            return 0x02;

        case 19200:
            return 0x03;

        case 9600:
            return 0x04;

        case 230400:
            return 0x05;

        case 250000:
            return 0x06;

        case 460800:
            return 0x07;

        case 500000:
            return 0x08;

        case 720000:
            return 0x09;

        case 921600:
            return 0x0A;

        case 1000000:
            return 0x0B;

        case 125000:
            return 0x0C;

        case 2000000:
            return 0x0D;

        case 3000000:
            return 0x0E;

        case 4000000:
            return 0x0F;

        case 1600000:
            return 0x10;

        case 3200000:
            return 0x11;

        case 3500000:
            return 0x12;

        default:
            break;
    }

    return 0x0E;
}

CsrBool CsrHciGetPatchNvmFileName(CsrUint16 socVer, CsrUint16 romeBuildVer)
{
    CsrUint32 i;
    CsrBool result = FALSE;
    
    for (i=0; i<CSR_ROME_PATCH_NVM_MAP_LEN; i++)
    {
        if (socVer == rome_patch_nvm_map[i].socVer && romeBuildVer == rome_patch_nvm_map[i].romeBuildVer)
        {
            bt_rome_ram_patch_file = rome_patch_nvm_map[i].ram_patch_file_name;
            bt_rome_nvm_file = rome_patch_nvm_map[i].nvm_file_name;
            result = TRUE;
        }
    }

    return result;
}

CsrBool CsrUpdateNvmTags(CsrUint8 *buffer)
{
    CsrUint32 nvm_length, nvm_index;
    tlv_patch_info *ptlv_header;
    tlv_nvm_hdr *nvm_ptr;
    CsrUint8 *nvm_byte_ptr;
    CsrUint16 ibs_value;
    
    ptlv_header = (tlv_patch_info *)buffer;
    
    if (ptlv_header->tlv_type == BINARY_FILE_TYPE_NVM)
    {
        nvm_length = (ptlv_header->tlv_length1) |
                     (ptlv_header->tlv_length2 << 8) |
                     (ptlv_header->tlv_length3 << 16);

        if(nvm_length <= 0)
            return FALSE;

        for (nvm_byte_ptr = (unsigned char *)(nvm_ptr = &(ptlv_header->tlv.nvm)), nvm_index=0;
             nvm_index < nvm_length ; nvm_ptr = (tlv_nvm_hdr *) nvm_byte_ptr)
        {
            /* Increase nvm_index to NVM data */
            nvm_index+=sizeof(tlv_nvm_hdr);
            nvm_byte_ptr+=sizeof(tlv_nvm_hdr);
        
            /* Write BD Address */
            if (nvm_ptr->tag_id == TAG_SET_BT_ADDR)
            {
                CsrMemCpy(nvm_byte_ptr, (const CsrUint8 *)saved_bt_bd_addr, CSR_QSOC_MAX_BD_ADDRESS_SIZE);
            }

            if (nvm_ptr->tag_id == TAG_TRANSPORT_PARAM)
            {
                /*  Currently synergy framework does not support in-band sleep over H4 HCI, 
                    disable this feature in nvm file. */
                ibs_value = FWCONF_IBS_DISABLE;
        
                if (ibs_value == FWCONF_IBS_DISABLE)
                {
                    nvm_byte_ptr[FWCONF_IBS_VAL_OFFSET] &= (~(FWCONF_IBS_ENABLE << FWCONF_IBS_VAL_BIT));
                } 
                else if (ibs_value == FWCONF_IBS_ENABLE)
                {
                    nvm_byte_ptr[FWCONF_IBS_VAL_OFFSET] |= (FWCONF_IBS_ENABLE << FWCONF_IBS_VAL_BIT);
                }
                
                *(nvm_byte_ptr + 2) = CsrQsocBaudrateMap(CsrUartDrvGetResetBaudrate(NULL));

                break;
            }
        
            /* increased by tag_len */
            nvm_index+=nvm_ptr->tag_len;
            nvm_byte_ptr +=nvm_ptr->tag_len;
        }
    }

    return TRUE;
}

CsrUint8 *CsrTmBluecoreReadBinFile(CsrUint8 fileType, CsrSize *length)
{
    CsrFileHandle *fh;
    CsrDirEntryStat filestat;
    CsrResult res;
    CsrCharString *filename = (fileType == BINARY_FILE_TYPE_TLV) ? bt_rome_ram_patch_file : bt_rome_nvm_file;
    CsrCharString *pBuffer = NULL;

    res = CsrFileOpen(&fh, (const CsrUtf8String*)filename,
                      CSR_FILE_OPEN_FLAGS_READ_ONLY,
                      CSR_FILE_PERMS_USER_READ);
    /* Scan file */
    if(res == CSR_RESULT_SUCCESS)
    {
        res = CsrDirStat((const CsrUtf8String*)filename, &filestat);
        if (res == CSR_RESULT_SUCCESS && filestat.size > 0)
        {
            pBuffer = (CsrCharString *)CsrPmemZalloc(filestat.size);
            if (pBuffer != NULL)
            {
                res = CsrFileRead(pBuffer, (CsrSize)filestat.size, fh, length);
                if (res != CSR_RESULT_SUCCESS)
                {
                    CsrPmemFree(pBuffer);
                }
            }
        }

        CsrFileClose(fh);
    }
    else if (fileType == BINARY_FILE_TYPE_NVM)
    {
        pBuffer = (CsrCharString *)CsrPmemZalloc(sizeof(nvm_file_string));
        CsrMemCpy(pBuffer, nvm_file_string, sizeof(nvm_file_string));
        *length = sizeof(nvm_file_string);
    }

    return (CsrUint8 *)pBuffer;
}
#endif /* CSR_BOOT_QCA_CHIP_INTERNALLY */
#endif /* CSR_USE_QCA_CHIP */

